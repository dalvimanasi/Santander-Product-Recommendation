{"paragraphs":[{"text":"%md\n#Introduction\nThis notebook cleans the data for Santander Product Recommendation competition.\n","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845938_1672054753","id":"20161130-225953_1582619578","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Introduction</h1>\n<p>This notebook cleans the data for Santander Product Recommendation competition.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4336"},{"text":"%md\n#Data Loading\n\n\nLoading required libraries.","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845938_1672054753","id":"20161130-230857_201075408","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Data Loading</h1>\n<p>Loading required libraries.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4337"},{"text":"%dep\nz.reset()\nz.addRepo(\"Spark Packages Repo\").url(\"http://dl.bintray.com/spark-packages/maven\")\nz.load(\"com.databricks:spark-csv_2.10:1.2.0\")\n\n\nimport org.apache.spark.sql.functions.udf\n\nimport util.Random._","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845939_1671670004","id":"20161129-145316_1193023666","result":{"code":"SUCCESS","type":"TEXT","msg":"DepInterpreter(%dep) deprecated. Remove dependencies and repositories through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Add repository through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nimport org.apache.spark.sql.functions.udf\nimport util.Random._\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4338"},{"text":"%md\nLoading the data from csv file using spark-csv library. \nCreating spark DataFrame from the loaded data. \nRegistering the DataFrame as temp table to query it using spark-sql.","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845939_1671670004","id":"20161130-231123_1605224947","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Loading the data from csv file using spark-csv library.\n<br  />Creating spark DataFrame from the loaded data.\n<br  />Registering the DataFrame as temp table to query it using spark-sql.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4339"},{"text":"  val trainData1 = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/home/manasi/Documents/scla/train_ver2.csv\")\n\ntrainData1.toDF().registerTempTable(\"Data\")","dateUpdated":"2016-12-09T01:06:49-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":161,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845939_1671670004","id":"20161126-122116_458867020","result":{"code":"SUCCESS","type":"TEXT","msg":"\ntrainData1: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 46 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"dateCreated":"2016-12-05T03:00:45-0500","dateStarted":"2016-12-09T01:06:49-0500","dateFinished":"2016-12-09T01:08:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4340","focus":true},{"text":"%md\n#Data cleaning\n\nInvestigating the data type of the columns.\nChecking the columns with null values.\n","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845940_1669746260","id":"20161130-231655_247914854","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Data cleaning</h1>\n<p>Investigating the data type of the columns.\n<br  />Checking the columns with null values.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4341"},{"text":"trainData.printSchema()","dateUpdated":"2016-12-09T04:29:45-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845940_1669746260","id":"20161130-231946_1414714797","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- fecha_dato: string (nullable = true)\n |-- ncodpers: double (nullable = true)\n |-- ind_empleado: string (nullable = true)\n |-- pais_residencia: string (nullable = true)\n |-- sexo: string (nullable = true)\n |-- age: string (nullable = true)\n |-- fecha_alta: string (nullable = true)\n |-- ind_nuevo: string (nullable = true)\n |-- antiguedad: string (nullable = true)\n |-- indrel: string (nullable = true)\n |-- ult_fec_cli_1t: string (nullable = true)\n |-- indrel_1mes: string (nullable = true)\n |-- tiprel_1mes: string (nullable = true)\n |-- indresi: string (nullable = true)\n |-- indext: string (nullable = true)\n |-- conyuemp: string (nullable = true)\n |-- canal_entrada: string (nullable = true)\n |-- indfall: string (nullable = true)\n |-- tipodom: string (nullable = true)\n |-- cod_prov: string (nullable = true)\n |-- nomprov: string (nullable = true)\n |-- ind_actividad_cliente: string (nullable = true)\n |-- renta: double (nullable = true)\n |-- segmento: string (nullable = true)\n |-- ind_ahor_fin_ult1: integer (nullable = true)\n |-- ind_aval_fin_ult1: integer (nullable = true)\n |-- ind_cco_fin_ult1: integer (nullable = true)\n |-- ind_cder_fin_ult1: integer (nullable = true)\n |-- ind_cno_fin_ult1: integer (nullable = true)\n |-- ind_ctju_fin_ult1: integer (nullable = true)\n |-- ind_ctma_fin_ult1: integer (nullable = true)\n |-- ind_ctop_fin_ult1: integer (nullable = true)\n |-- ind_ctpp_fin_ult1: integer (nullable = true)\n |-- ind_deco_fin_ult1: integer (nullable = true)\n |-- ind_deme_fin_ult1: integer (nullable = true)\n |-- ind_dela_fin_ult1: integer (nullable = true)\n |-- ind_ecue_fin_ult1: integer (nullable = true)\n |-- ind_fond_fin_ult1: integer (nullable = true)\n |-- ind_hip_fin_ult1: integer (nullable = true)\n |-- ind_plan_fin_ult1: integer (nullable = true)\n |-- ind_pres_fin_ult1: integer (nullable = true)\n |-- ind_reca_fin_ult1: integer (nullable = true)\n |-- ind_tjcr_fin_ult1: integer (nullable = true)\n |-- ind_valo_fin_ult1: integer (nullable = true)\n |-- ind_viv_fin_ult1: integer (nullable = true)\n |-- ind_nomina_ult1: string (nullable = true)\n |-- ind_nom_pens_ult1: string (nullable = true)\n |-- ind_recibo_ult1: integer (nullable = true)\n\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4342"},{"text":"%md\n### 1. Sexo (Gender)\nFinding the distribution and null values.","dateUpdated":"2016-12-09T04:30:10-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845941_1669361511","id":"20161201-043741_1268125372","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>1. Sexo (Gender)</h3>\n<p>Finding the distribution and null values.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4343"},{"text":"%sql \nselect sexo, count(1) from Data group by sexo","dateUpdated":"2016-12-09T00:17:58-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":128,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845941_1669361511","id":"20161201-012913_165850282","result":{"code":"SUCCESS","type":"TABLE","msg":"sexo\t_c1\nH\t6195253\nV\t7424252\n\t27804\n","comment":"","msgTable":[[{"key":"_c1","value":"H"},{"key":"_c1","value":"6195253"}],[{"value":"V"},{"value":"7424252"}],[{"value":""},{"value":"27804"}]],"columnNames":[{"name":"sexo","index":0,"aggr":"sum"},{"name":"_c1","index":1,"aggr":"sum"}],"rows":[["H","6195253"],["V","7424252"],["","27804"]]},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4344"},{"text":"%md\nReplacing the null values with H an V while maintaing the same ratio between genders.","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845941_1669361511","id":"20161201-043915_1864654010","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Replacing the null values with H an V while maintaing the same ratio between genders.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4345"},{"text":"\n\n\n\nval cleanSexo:(String => String) = (sexo:String) => {val r = new scala.util.Random;\n                                                    sexo.replace(\" \",\"\") match {case \"\" => if(r.nextFloat>0.54) \"V\" else \"H\" case a => a}}\n\nval cleanSexoUDF = udf(cleanSexo)\n\nval newTrainData = trainData.withColumn(\"newSexo\", cleanSexoUDF(col(\"sexo\")))\n\nnewTrainData.toDF().registerTempTable(\"newData\")\n\n","dateUpdated":"2016-12-09T00:18:30-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845941_1669361511","id":"20161201-012434_1503775016","result":{"code":"SUCCESS","type":"TEXT","msg":"\ncleanSexo: String => String = <function1>\n\ncleanSexoUDF: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(StringType))\nnewTrainData: org.apache.spark.sql.DataFrame = [fecha_dato: string, ncodpers: double, ind_empleado: string, pais_residencia: string, sexo: string, age: string, fecha_alta: string, ind_nuevo: string, antiguedad: string, indrel: string, ult_fec_cli_1t: string, indrel_1mes: string, tiprel_1mes: string, indresi: string, indext: string, conyuemp: string, canal_entrada: string, indfall: string, tipodom: string, cod_prov: string, nomprov: string, ind_actividad_cliente: string, renta: double, segmento: string, ind_ahor_fin_ult1: int, ind_aval_fin_ult1: int, ind_cco_fin_ult1: int, ind_cder_fin_ult1: int, ind_cno_fin_ult1: int, ind_ctju_fin_ult1: int, ind_ctma_fin_ult1: int, ind_ctop_fin_ult1: int, ind_ctpp_fin_ult1: int, ind_deco_fin_ult1: int, ind_deme_fin_ult1: int, ind_dela_fin_ult1: int, ind..."},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4346"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481275817919_-1076066654","id":"20161209-043017_2030433138","dateCreated":"2016-12-09T04:30:17-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11080","text":"%sql select newSexo,count(*) from newData group by newSexo","dateUpdated":"2016-12-09T04:31:20-0500"},{"text":"%md \n###2. Age \nChecking the distribution of age.","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845942_1670515758","id":"20161201-044716_1124470536","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>2. Age</h3>\n<p>Checking the distribution of age.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4347"},{"text":"%sql\nselect age, count(1) as count from Data  group by age","dateUpdated":"2016-12-05T03:49:25-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845942_1670515758","id":"20161129-151446_1953928383","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tcount\n 50\t236383\n 51\t223297\n 52\t211611\n 53\t202527\n 54\t181511\n 55\t165355\n 56\t151340\n 57\t144645\n 58\t134739\n 59\t124177\n110\t261\n111\t252\n112\t188\n113\t117\n114\t22\n115\t82\n116\t63\n117\t14\n 60\t117834\n 61\t108356\n 62\t101186\n 63\t91521\n 64\t87398\n 65\t84750\n 66\t81343\n 67\t77693\n 68\t78361\n 69\t77745\n126\t3\n127\t8\n 70\t70192\n 71\t66825\n 72\t67664\n 73\t64431\n 74\t59086\n 75\t50597\n 76\t48997\n 77\t49218\n 78\t34358\n 79\t35065\n 10\t7950\n 11\t10481\n 12\t12546\n 13\t12745\n 14\t12667\n 15\t13118\n 16\t11759\n 17\t11953\n 18\t10989\n 19\t21597\n 80\t35773\n 81\t38217\n 82\t33938\n 83\t31860\n 84\t30124\n 85\t27754\n 86\t24956\n 87\t23648\n 88\t21718\n 89\t19175\n 20\t422867\n 21\t675988\n 22\t736314\n 23\t779884\n 24\t734785\n 25\t472016\n 26\t347778\n 27\t281981\n 28\t240192\n 29\t205709\n 90\t16863\n 91\t15098\n 92\t13492\n 93\t11642\n 94\t10085\n 95\t8511\n 96\t7480\n 97\t5962\n 98\t4622\n 99\t3617\n 30\t186040\n 31\t167985\n 32\t169537\n 33\t170477\n 34\t174574\n 35\t183577\n 36\t198422\n 37\t212420\n 38\t231963\n 39\t260548\n  2\t733\n  3\t1534\n  4\t2210\n  5\t3004\n  6\t3673\n  7\t3792\n  8\t4744\n  9\t5887\n 40\t287754\n 41\t309051\n 42\t319713\n163\t8\n 43\t324303\n164\t3\n 44\t322955\n 45\t314771\n 46\t299365\n 47\t286505\n 48\t271576\n 49\t250484\n100\t3050\n101\t2666\n102\t2335\n103\t2003\n104\t1350\n105\t1280\n106\t899\n107\t594\n108\t456\n109\t265\n NA\t27734\n","comment":"","msgTable":[[{"key":"count","value":" 50"},{"key":"count","value":"236383"}],[{"value":" 51"},{"value":"223297"}],[{"value":" 52"},{"value":"211611"}],[{"value":" 53"},{"value":"202527"}],[{"value":" 54"},{"value":"181511"}],[{"value":" 55"},{"value":"165355"}],[{"value":" 56"},{"value":"151340"}],[{"value":" 57"},{"value":"144645"}],[{"value":" 58"},{"value":"134739"}],[{"value":" 59"},{"value":"124177"}],[{"value":"110"},{"value":"261"}],[{"value":"111"},{"value":"252"}],[{"value":"112"},{"value":"188"}],[{"value":"113"},{"value":"117"}],[{"value":"114"},{"value":"22"}],[{"value":"115"},{"value":"82"}],[{"value":"116"},{"value":"63"}],[{"value":"117"},{"value":"14"}],[{"value":" 60"},{"value":"117834"}],[{"value":" 61"},{"value":"108356"}],[{"value":" 62"},{"value":"101186"}],[{"value":" 63"},{"value":"91521"}],[{"value":" 64"},{"value":"87398"}],[{"value":" 65"},{"value":"84750"}],[{"value":" 66"},{"value":"81343"}],[{"value":" 67"},{"value":"77693"}],[{"value":" 68"},{"value":"78361"}],[{"value":" 69"},{"value":"77745"}],[{"value":"126"},{"value":"3"}],[{"value":"127"},{"value":"8"}],[{"value":" 70"},{"value":"70192"}],[{"value":" 71"},{"value":"66825"}],[{"value":" 72"},{"value":"67664"}],[{"value":" 73"},{"value":"64431"}],[{"value":" 74"},{"value":"59086"}],[{"value":" 75"},{"value":"50597"}],[{"value":" 76"},{"value":"48997"}],[{"value":" 77"},{"value":"49218"}],[{"value":" 78"},{"value":"34358"}],[{"value":" 79"},{"value":"35065"}],[{"value":" 10"},{"value":"7950"}],[{"value":" 11"},{"value":"10481"}],[{"value":" 12"},{"value":"12546"}],[{"value":" 13"},{"value":"12745"}],[{"value":" 14"},{"value":"12667"}],[{"value":" 15"},{"value":"13118"}],[{"value":" 16"},{"value":"11759"}],[{"value":" 17"},{"value":"11953"}],[{"value":" 18"},{"value":"10989"}],[{"value":" 19"},{"value":"21597"}],[{"value":" 80"},{"value":"35773"}],[{"value":" 81"},{"value":"38217"}],[{"value":" 82"},{"value":"33938"}],[{"value":" 83"},{"value":"31860"}],[{"value":" 84"},{"value":"30124"}],[{"value":" 85"},{"value":"27754"}],[{"value":" 86"},{"value":"24956"}],[{"value":" 87"},{"value":"23648"}],[{"value":" 88"},{"value":"21718"}],[{"value":" 89"},{"value":"19175"}],[{"value":" 20"},{"value":"422867"}],[{"value":" 21"},{"value":"675988"}],[{"value":" 22"},{"value":"736314"}],[{"value":" 23"},{"value":"779884"}],[{"value":" 24"},{"value":"734785"}],[{"value":" 25"},{"value":"472016"}],[{"value":" 26"},{"value":"347778"}],[{"value":" 27"},{"value":"281981"}],[{"value":" 28"},{"value":"240192"}],[{"value":" 29"},{"value":"205709"}],[{"value":" 90"},{"value":"16863"}],[{"value":" 91"},{"value":"15098"}],[{"value":" 92"},{"value":"13492"}],[{"value":" 93"},{"value":"11642"}],[{"value":" 94"},{"value":"10085"}],[{"value":" 95"},{"value":"8511"}],[{"value":" 96"},{"value":"7480"}],[{"value":" 97"},{"value":"5962"}],[{"value":" 98"},{"value":"4622"}],[{"value":" 99"},{"value":"3617"}],[{"value":" 30"},{"value":"186040"}],[{"value":" 31"},{"value":"167985"}],[{"value":" 32"},{"value":"169537"}],[{"value":" 33"},{"value":"170477"}],[{"value":" 34"},{"value":"174574"}],[{"value":" 35"},{"value":"183577"}],[{"value":" 36"},{"value":"198422"}],[{"value":" 37"},{"value":"212420"}],[{"value":" 38"},{"value":"231963"}],[{"value":" 39"},{"value":"260548"}],[{"value":"  2"},{"value":"733"}],[{"value":"  3"},{"value":"1534"}],[{"value":"  4"},{"value":"2210"}],[{"value":"  5"},{"value":"3004"}],[{"value":"  6"},{"value":"3673"}],[{"value":"  7"},{"value":"3792"}],[{"value":"  8"},{"value":"4744"}],[{"value":"  9"},{"value":"5887"}],[{"value":" 40"},{"value":"287754"}],[{"value":" 41"},{"value":"309051"}],[{"value":" 42"},{"value":"319713"}],[{"value":"163"},{"value":"8"}],[{"value":" 43"},{"value":"324303"}],[{"value":"164"},{"value":"3"}],[{"value":" 44"},{"value":"322955"}],[{"value":" 45"},{"value":"314771"}],[{"value":" 46"},{"value":"299365"}],[{"value":" 47"},{"value":"286505"}],[{"value":" 48"},{"value":"271576"}],[{"value":" 49"},{"value":"250484"}],[{"value":"100"},{"value":"3050"}],[{"value":"101"},{"value":"2666"}],[{"value":"102"},{"value":"2335"}],[{"value":"103"},{"value":"2003"}],[{"value":"104"},{"value":"1350"}],[{"value":"105"},{"value":"1280"}],[{"value":"106"},{"value":"899"}],[{"value":"107"},{"value":"594"}],[{"value":"108"},{"value":"456"}],[{"value":"109"},{"value":"265"}],[{"value":" NA"},{"value":"27734"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[[" 50","236383"],[" 51","223297"],[" 52","211611"],[" 53","202527"],[" 54","181511"],[" 55","165355"],[" 56","151340"],[" 57","144645"],[" 58","134739"],[" 59","124177"],["110","261"],["111","252"],["112","188"],["113","117"],["114","22"],["115","82"],["116","63"],["117","14"],[" 60","117834"],[" 61","108356"],[" 62","101186"],[" 63","91521"],[" 64","87398"],[" 65","84750"],[" 66","81343"],[" 67","77693"],[" 68","78361"],[" 69","77745"],["126","3"],["127","8"],[" 70","70192"],[" 71","66825"],[" 72","67664"],[" 73","64431"],[" 74","59086"],[" 75","50597"],[" 76","48997"],[" 77","49218"],[" 78","34358"],[" 79","35065"],[" 10","7950"],[" 11","10481"],[" 12","12546"],[" 13","12745"],[" 14","12667"],[" 15","13118"],[" 16","11759"],[" 17","11953"],[" 18","10989"],[" 19","21597"],[" 80","35773"],[" 81","38217"],[" 82","33938"],[" 83","31860"],[" 84","30124"],[" 85","27754"],[" 86","24956"],[" 87","23648"],[" 88","21718"],[" 89","19175"],[" 20","422867"],[" 21","675988"],[" 22","736314"],[" 23","779884"],[" 24","734785"],[" 25","472016"],[" 26","347778"],[" 27","281981"],[" 28","240192"],[" 29","205709"],[" 90","16863"],[" 91","15098"],[" 92","13492"],[" 93","11642"],[" 94","10085"],[" 95","8511"],[" 96","7480"],[" 97","5962"],[" 98","4622"],[" 99","3617"],[" 30","186040"],[" 31","167985"],[" 32","169537"],[" 33","170477"],[" 34","174574"],[" 35","183577"],[" 36","198422"],[" 37","212420"],[" 38","231963"],[" 39","260548"],["  2","733"],["  3","1534"],["  4","2210"],["  5","3004"],["  6","3673"],["  7","3792"],["  8","4744"],["  9","5887"],[" 40","287754"],[" 41","309051"],[" 42","319713"],["163","8"],[" 43","324303"],["164","3"],[" 44","322955"],[" 45","314771"],[" 46","299365"],[" 47","286505"],[" 48","271576"],[" 49","250484"],["100","3050"],["101","2666"],["102","2335"],["103","2003"],["104","1350"],["105","1280"],["106","899"],["107","594"],["108","456"],["109","265"],[" NA","27734"]]},"dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4348"},{"text":"%md\nreplacing NA with 0 and converting the data type to Int.","dateUpdated":"2016-12-09T04:31:20-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845943_1670131009","id":"20161201-021853_868170279","result":{"code":"SUCCESS","type":"HTML","msg":"<p>replacing NA with 0 and converting the data type to Int.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","dateStarted":"2016-12-05T03:04:26-0500","dateFinished":"2016-12-05T03:04:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4349"},{"text":"val cleanAgeFunc:(String => Int) = (age:String) => { age.replace(\" \",\"\") match {case \"NA\" => 0  case a => a.toInt}}\n\nval cleanAge = udf(cleanAgeFunc)\n\nval newTrainData2 = newTrainData.withColumn(\"newAge\", cleanAge(col(\"age\")))\n\nnewTrainData2.toDF().registerTempTable(\"newData2\")","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845944_1668207264","id":"20161129-151631_450722943","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4350"},{"text":"%sql\nselect newAge as Age, count(1) as count from newData group by newAge","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":false,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"Age","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Age","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845944_1668207264","id":"20161129-153131_496931187","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4351"},{"text":"%md \n###3. ind_nuevo (New Customer Index)\nChecking the null values in ind_nuevo.","dateUpdated":"2016-12-09T04:31:29-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845944_1668207264","id":"20161129-180233_1892479440","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>3. ind_nuevo (New Customer Index)</h3>\n<p>Checking the null values in ind_nuevo.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","dateStarted":"2016-12-05T03:04:15-0500","dateFinished":"2016-12-05T03:04:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4352"},{"text":"%sql\n\nselect ind_nuevo, count(1) from Data group by ind_nuevo","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"graph":{"mode":"table","height":124,"optionOpen":false,"keys":[{"name":"ind_nuevo","index":0,"aggr":"sum"}],"values":[{"name":"_c1","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ind_nuevo","index":0,"aggr":"sum"},"yAxis":{"name":"_c1","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/sql","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845944_1668207264","id":"20161201-024829_501527694","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4353"},{"text":"%md\n\nThere are 27,734 null values for ind_nuevo. We check the number of months of history these customers have to set the new customer index.","dateUpdated":"2016-12-09T04:31:49-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845944_1668207264","id":"20161201-024940_2037119987","dateCreated":"2016-12-05T03:00:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4354","dateFinished":"2016-12-09T04:31:44-0500","dateStarted":"2016-12-09T04:31:39-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>There are 27,734 null values for ind_nuevo. We check the number of months of history these customers have to set the new customer index.</p>\n"},"focus":true},{"text":"%sql\nselect max(count) as maxCount from (select ncodpers, count(1) as count from (select ncodpers, fecha_dato from Data where ind_nuevo = \"NA\") tempTable group by ncodpers) tempTable2 ","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":88,"optionOpen":false,"keys":[{"name":"_c0","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"_c0","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-025336_1895408609","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4355"},{"text":"%md\nThe maximum months of history available for these customers is 6 months. Hence we can replace the NA values with 1, i.e we will be treating these customers as new customers.","dateUpdated":"2016-12-09T04:31:58-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-032625_2135210110","dateCreated":"2016-12-05T03:00:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4356","dateFinished":"2016-12-09T04:31:54-0500","dateStarted":"2016-12-09T04:31:54-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>The maximum months of history available for these customers is 6 months. Hence we can replace the NA values with 1, i.e we will be treating these customers as new customers.</p>\n"},"focus":true},{"text":"val cleanInd_nuevo:(String => Int) = (ind_nuevo:String) => { ind_nuevo.replace(\" \",\"\") match {case \"NA\" => 1  case a => a.toInt}}\n\nval cleanInd_nuevoUDF = udf(cleanInd_nuevo)\n\nval newtrainData3 = newtrainData2.withColumn(\"newInd_nuevo\", cleanInd_nuevoUDF(col(\"ind_nuevo\")))\n\nnewTrainData3.toDF().registerTempTable(\"newData3\")\n\n","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-025641_1305285534","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4357"},{"text":"%md\n###4. Antiguedad (Customer Seniority in Months) \nChecking the distribution for antiguedad.","dateUpdated":"2016-12-09T04:32:15-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-040755_1633889383","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>4. Antiguedad (Customer Seniority in Months)</h3>\n<p>Checking the distribution for antiguedad.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","dateStarted":"2016-12-05T03:03:59-0500","dateFinished":"2016-12-05T03:03:59-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4358"},{"text":"%md\nCustomer seniority of -999,999 months doesn't make any sense. Replacing -999,999 by 0.","dateUpdated":"2016-12-09T04:35:40-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-040049_1674195974","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Customer seniority of -999,999 months doesn't make any sense. Replacing -999,999 by 0.</p>\n"},"dateCreated":"2016-12-05T03:00:45-0500","dateStarted":"2016-12-05T03:03:52-0500","dateFinished":"2016-12-05T03:03:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4359"},{"text":"%sql \nselect antiguedad, count(*) as count from Data group by antiguedad order by antiguedad","dateUpdated":"2016-12-05T03:00:45-0500","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"antiguedad","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"antiguedad","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/sql","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845945_1667822515","id":"20161201-033433_1129002001","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4360"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481275946025_1509228127","id":"20161209-043226_1178961943","dateCreated":"2016-12-09T04:32:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11229","text":"%md\n### 5. Antigaugedad (Customer Seniority)","dateUpdated":"2016-12-09T04:35:24-0500","dateFinished":"2016-12-09T04:33:21-0500","dateStarted":"2016-12-09T04:33:21-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>5. Antigaugedad (Customer Seniority)</h3>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"antiguedad","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"antiguedad","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481276007887_-486941112","id":"20161209-043327_145861778","dateCreated":"2016-12-09T04:33:27-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11320","text":"%sql select antiguedad,count(*) from Data group by antiguedad","dateUpdated":"2016-12-09T04:35:04-0500","dateFinished":"2016-12-09T04:34:45-0500","dateStarted":"2016-12-09T04:34:16-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"antiguedad\tcount(1)\n     23\t177839\n    125\t44840\n    248\t2271\n    137\t42125\n     71\t23884\n    247\t3516\n     58\t27872\n     89\t43522\n    132\t37756\n    184\t37326\n    155\t30901\n     75\t14452\n     28\t104820\n    104\t47069\n     79\t25547\n     68\t27920\n    156\t45711\n    201\t25223\n     26\t113488\n    134\t44164\n    141\t40247\n    131\t33914\n    175\t47404\n    191\t23170\n    240\t9036\n     64\t34156\n    197\t23276\n      2\t130259\n     56\t46126\n    119\t46804\n    198\t24273\n     88\t41999\n     12\t243160\n    215\t17517\n    101\t41775\n    243\t6514\n     54\t72079\n    211\t23119\n      8\t155703\n    164\t70881\n     85\t38358\n     39\t98125\n     13\t123990\n     45\t168847\n     15\t121716\n      0\t134484\n    253\t416\n     16\t135307\n     19\t118696\n    171\t59743\n     67\t26750\n      6\t127176\n     91\t39083\n     95\t41357\n    116\t42545\n     70\t24568\n     33\t174352\n     14\t126798\n    203\t18935\n    174\t55081\n    230\t10861\n    142\t40259\n    117\t55269\n    146\t38655\n    229\t11613\n     60\t22934\n     21\t214795\n     29\t102815\n     61\t28088\n     41\t99968\n    122\t38740\n     65\t29607\n     59\t24000\n    218\t17178\n    254\t261\n     66\t29860\n    237\t13165\n    228\t11920\n    206\t24321\n    188\t29274\n    160\t54189\n    147\t34702\n    113\t43487\n     35\t149736\n    200\t24366\n    162\t68136\n     80\t33806\n    112\t44902\n    222\t13614\n    255\t179\n     27\t107958\n    108\t45405\n     97\t42657\n    148\t36050\n    106\t43133\n    124\t42852\n    153\t37289\n     90\t42134\n     34\t147957\n    220\t16597\n     32\t139023\n    209\t23523\n    107\t46520\n    154\t33611\n     17\t125055\n    199\t25946\n    224\t13311\n     47\t123834\n    127\t41115\n     77\t24407\n    100\t38496\n    183\t32233\n     73\t19255\n     63\t34876\n      4\t127442\n     62\t31148\n    170\t61918\n     18\t125186\n     50\t85950\n     53\t82864\n    178\t44937\n    225\t14694\n    180\t44308\n      7\t129262\n    212\t22007\n    115\t43466\n    167\t52500\n     NA\t27734\n     25\t108448\n    216\t17884\n    128\t41646\n     44\t150837\n     11\t124718\n     42\t92558\n    126\t43989\n    114\t45440\n    195\t25666\n    205\t21667\n    118\t46059\n    105\t50504\n    163\t60463\n     96\t43555\n     83\t38632\n    235\t10836\n      1\t132579\n    182\t34677\n    196\t23627\n     43\t136555\n    139\t38921\n    187\t29438\n     86\t40718\n     57\t34772\n    102\t47575\n    185\t35841\n    158\t39484\n    179\t38597\n    210\t20742\n    233\t9198\n    135\t37274\n    244\t5928\n    214\t18696\n     40\t103485\n    251\t1071\n    111\t43661\n     94\t39945\n    136\t41000\n    192\t22947\n    176\t44779\n    181\t33532\n     48\t118825\n     72\t23631\n     46\t141724\n     52\t85728\n    161\t58927\n     31\t109500\n     76\t17565\n    207\t22095\n    223\t14827\n    246\t4591\n    177\t47797\n     69\t26134\n    138\t42286\n     36\t164425\n    151\t38502\n     74\t16021\n     99\t38017\n    172\t66085\n    242\t7425\n-999999\t38\n    110\t49349\n    145\t37074\n    227\t10426\n     82\t37311\n    217\t18326\n    202\t21995\n     92\t37944\n    109\t44028\n    194\t26804\n    186\t31362\n    204\t19416\n    159\t50979\n    123\t41074\n     84\t38932\n    226\t11554\n    239\t8056\n    149\t35193\n      3\t132745\n    120\t43559\n    256\t102\n    140\t40709\n     78\t25912\n     10\t206165\n     37\t100490\n     49\t85959\n    232\t11134\n    169\t65661\n    241\t8953\n    143\t37491\n    133\t38325\n    213\t19719\n    144\t38786\n    231\t13120\n    234\t10347\n     24\t167059\n    249\t1777\n      5\t139618\n    150\t37796\n     38\t105792\n    103\t42265\n    250\t1512\n     93\t43732\n     22\t154809\n    168\t63868\n    157\t40426\n     51\t79347\n     81\t48081\n    129\t39373\n    189\t29649\n    236\t9118\n     30\t103117\n    152\t36810\n    252\t676\n     20\t145050\n    166\t66459\n    208\t23776\n    238\t10728\n    245\t4918\n     98\t42558\n    121\t38277\n    193\t28184\n    190\t24677\n    173\t54753\n    219\t15405\n    165\t74845\n    130\t38667\n      9\t177957\n     55\t60730\n     87\t43207\n    221\t15868\n","comment":"","msgTable":[[{"key":"count(1)","value":"     23"},{"key":"count(1)","value":"177839"}],[{"value":"    125"},{"value":"44840"}],[{"value":"    248"},{"value":"2271"}],[{"value":"    137"},{"value":"42125"}],[{"value":"     71"},{"value":"23884"}],[{"value":"    247"},{"value":"3516"}],[{"value":"     58"},{"value":"27872"}],[{"value":"     89"},{"value":"43522"}],[{"value":"    132"},{"value":"37756"}],[{"value":"    184"},{"value":"37326"}],[{"value":"    155"},{"value":"30901"}],[{"value":"     75"},{"value":"14452"}],[{"value":"     28"},{"value":"104820"}],[{"value":"    104"},{"value":"47069"}],[{"value":"     79"},{"value":"25547"}],[{"value":"     68"},{"value":"27920"}],[{"value":"    156"},{"value":"45711"}],[{"value":"    201"},{"value":"25223"}],[{"value":"     26"},{"value":"113488"}],[{"value":"    134"},{"value":"44164"}],[{"value":"    141"},{"value":"40247"}],[{"value":"    131"},{"value":"33914"}],[{"value":"    175"},{"value":"47404"}],[{"value":"    191"},{"value":"23170"}],[{"value":"    240"},{"value":"9036"}],[{"value":"     64"},{"value":"34156"}],[{"value":"    197"},{"value":"23276"}],[{"value":"      2"},{"value":"130259"}],[{"value":"     56"},{"value":"46126"}],[{"value":"    119"},{"value":"46804"}],[{"value":"    198"},{"value":"24273"}],[{"value":"     88"},{"value":"41999"}],[{"value":"     12"},{"value":"243160"}],[{"value":"    215"},{"value":"17517"}],[{"value":"    101"},{"value":"41775"}],[{"value":"    243"},{"value":"6514"}],[{"value":"     54"},{"value":"72079"}],[{"value":"    211"},{"value":"23119"}],[{"value":"      8"},{"value":"155703"}],[{"value":"    164"},{"value":"70881"}],[{"value":"     85"},{"value":"38358"}],[{"value":"     39"},{"value":"98125"}],[{"value":"     13"},{"value":"123990"}],[{"value":"     45"},{"value":"168847"}],[{"value":"     15"},{"value":"121716"}],[{"value":"      0"},{"value":"134484"}],[{"value":"    253"},{"value":"416"}],[{"value":"     16"},{"value":"135307"}],[{"value":"     19"},{"value":"118696"}],[{"value":"    171"},{"value":"59743"}],[{"value":"     67"},{"value":"26750"}],[{"value":"      6"},{"value":"127176"}],[{"value":"     91"},{"value":"39083"}],[{"value":"     95"},{"value":"41357"}],[{"value":"    116"},{"value":"42545"}],[{"value":"     70"},{"value":"24568"}],[{"value":"     33"},{"value":"174352"}],[{"value":"     14"},{"value":"126798"}],[{"value":"    203"},{"value":"18935"}],[{"value":"    174"},{"value":"55081"}],[{"value":"    230"},{"value":"10861"}],[{"value":"    142"},{"value":"40259"}],[{"value":"    117"},{"value":"55269"}],[{"value":"    146"},{"value":"38655"}],[{"value":"    229"},{"value":"11613"}],[{"value":"     60"},{"value":"22934"}],[{"value":"     21"},{"value":"214795"}],[{"value":"     29"},{"value":"102815"}],[{"value":"     61"},{"value":"28088"}],[{"value":"     41"},{"value":"99968"}],[{"value":"    122"},{"value":"38740"}],[{"value":"     65"},{"value":"29607"}],[{"value":"     59"},{"value":"24000"}],[{"value":"    218"},{"value":"17178"}],[{"value":"    254"},{"value":"261"}],[{"value":"     66"},{"value":"29860"}],[{"value":"    237"},{"value":"13165"}],[{"value":"    228"},{"value":"11920"}],[{"value":"    206"},{"value":"24321"}],[{"value":"    188"},{"value":"29274"}],[{"value":"    160"},{"value":"54189"}],[{"value":"    147"},{"value":"34702"}],[{"value":"    113"},{"value":"43487"}],[{"value":"     35"},{"value":"149736"}],[{"value":"    200"},{"value":"24366"}],[{"value":"    162"},{"value":"68136"}],[{"value":"     80"},{"value":"33806"}],[{"value":"    112"},{"value":"44902"}],[{"value":"    222"},{"value":"13614"}],[{"value":"    255"},{"value":"179"}],[{"value":"     27"},{"value":"107958"}],[{"value":"    108"},{"value":"45405"}],[{"value":"     97"},{"value":"42657"}],[{"value":"    148"},{"value":"36050"}],[{"value":"    106"},{"value":"43133"}],[{"value":"    124"},{"value":"42852"}],[{"value":"    153"},{"value":"37289"}],[{"value":"     90"},{"value":"42134"}],[{"value":"     34"},{"value":"147957"}],[{"value":"    220"},{"value":"16597"}],[{"value":"     32"},{"value":"139023"}],[{"value":"    209"},{"value":"23523"}],[{"value":"    107"},{"value":"46520"}],[{"value":"    154"},{"value":"33611"}],[{"value":"     17"},{"value":"125055"}],[{"value":"    199"},{"value":"25946"}],[{"value":"    224"},{"value":"13311"}],[{"value":"     47"},{"value":"123834"}],[{"value":"    127"},{"value":"41115"}],[{"value":"     77"},{"value":"24407"}],[{"value":"    100"},{"value":"38496"}],[{"value":"    183"},{"value":"32233"}],[{"value":"     73"},{"value":"19255"}],[{"value":"     63"},{"value":"34876"}],[{"value":"      4"},{"value":"127442"}],[{"value":"     62"},{"value":"31148"}],[{"value":"    170"},{"value":"61918"}],[{"value":"     18"},{"value":"125186"}],[{"value":"     50"},{"value":"85950"}],[{"value":"     53"},{"value":"82864"}],[{"value":"    178"},{"value":"44937"}],[{"value":"    225"},{"value":"14694"}],[{"value":"    180"},{"value":"44308"}],[{"value":"      7"},{"value":"129262"}],[{"value":"    212"},{"value":"22007"}],[{"value":"    115"},{"value":"43466"}],[{"value":"    167"},{"value":"52500"}],[{"value":"     NA"},{"value":"27734"}],[{"value":"     25"},{"value":"108448"}],[{"value":"    216"},{"value":"17884"}],[{"value":"    128"},{"value":"41646"}],[{"value":"     44"},{"value":"150837"}],[{"value":"     11"},{"value":"124718"}],[{"value":"     42"},{"value":"92558"}],[{"value":"    126"},{"value":"43989"}],[{"value":"    114"},{"value":"45440"}],[{"value":"    195"},{"value":"25666"}],[{"value":"    205"},{"value":"21667"}],[{"value":"    118"},{"value":"46059"}],[{"value":"    105"},{"value":"50504"}],[{"value":"    163"},{"value":"60463"}],[{"value":"     96"},{"value":"43555"}],[{"value":"     83"},{"value":"38632"}],[{"value":"    235"},{"value":"10836"}],[{"value":"      1"},{"value":"132579"}],[{"value":"    182"},{"value":"34677"}],[{"value":"    196"},{"value":"23627"}],[{"value":"     43"},{"value":"136555"}],[{"value":"    139"},{"value":"38921"}],[{"value":"    187"},{"value":"29438"}],[{"value":"     86"},{"value":"40718"}],[{"value":"     57"},{"value":"34772"}],[{"value":"    102"},{"value":"47575"}],[{"value":"    185"},{"value":"35841"}],[{"value":"    158"},{"value":"39484"}],[{"value":"    179"},{"value":"38597"}],[{"value":"    210"},{"value":"20742"}],[{"value":"    233"},{"value":"9198"}],[{"value":"    135"},{"value":"37274"}],[{"value":"    244"},{"value":"5928"}],[{"value":"    214"},{"value":"18696"}],[{"value":"     40"},{"value":"103485"}],[{"value":"    251"},{"value":"1071"}],[{"value":"    111"},{"value":"43661"}],[{"value":"     94"},{"value":"39945"}],[{"value":"    136"},{"value":"41000"}],[{"value":"    192"},{"value":"22947"}],[{"value":"    176"},{"value":"44779"}],[{"value":"    181"},{"value":"33532"}],[{"value":"     48"},{"value":"118825"}],[{"value":"     72"},{"value":"23631"}],[{"value":"     46"},{"value":"141724"}],[{"value":"     52"},{"value":"85728"}],[{"value":"    161"},{"value":"58927"}],[{"value":"     31"},{"value":"109500"}],[{"value":"     76"},{"value":"17565"}],[{"value":"    207"},{"value":"22095"}],[{"value":"    223"},{"value":"14827"}],[{"value":"    246"},{"value":"4591"}],[{"value":"    177"},{"value":"47797"}],[{"value":"     69"},{"value":"26134"}],[{"value":"    138"},{"value":"42286"}],[{"value":"     36"},{"value":"164425"}],[{"value":"    151"},{"value":"38502"}],[{"value":"     74"},{"value":"16021"}],[{"value":"     99"},{"value":"38017"}],[{"value":"    172"},{"value":"66085"}],[{"value":"    242"},{"value":"7425"}],[{"value":"-999999"},{"value":"38"}],[{"value":"    110"},{"value":"49349"}],[{"value":"    145"},{"value":"37074"}],[{"value":"    227"},{"value":"10426"}],[{"value":"     82"},{"value":"37311"}],[{"value":"    217"},{"value":"18326"}],[{"value":"    202"},{"value":"21995"}],[{"value":"     92"},{"value":"37944"}],[{"value":"    109"},{"value":"44028"}],[{"value":"    194"},{"value":"26804"}],[{"value":"    186"},{"value":"31362"}],[{"value":"    204"},{"value":"19416"}],[{"value":"    159"},{"value":"50979"}],[{"value":"    123"},{"value":"41074"}],[{"value":"     84"},{"value":"38932"}],[{"value":"    226"},{"value":"11554"}],[{"value":"    239"},{"value":"8056"}],[{"value":"    149"},{"value":"35193"}],[{"value":"      3"},{"value":"132745"}],[{"value":"    120"},{"value":"43559"}],[{"value":"    256"},{"value":"102"}],[{"value":"    140"},{"value":"40709"}],[{"value":"     78"},{"value":"25912"}],[{"value":"     10"},{"value":"206165"}],[{"value":"     37"},{"value":"100490"}],[{"value":"     49"},{"value":"85959"}],[{"value":"    232"},{"value":"11134"}],[{"value":"    169"},{"value":"65661"}],[{"value":"    241"},{"value":"8953"}],[{"value":"    143"},{"value":"37491"}],[{"value":"    133"},{"value":"38325"}],[{"value":"    213"},{"value":"19719"}],[{"value":"    144"},{"value":"38786"}],[{"value":"    231"},{"value":"13120"}],[{"value":"    234"},{"value":"10347"}],[{"value":"     24"},{"value":"167059"}],[{"value":"    249"},{"value":"1777"}],[{"value":"      5"},{"value":"139618"}],[{"value":"    150"},{"value":"37796"}],[{"value":"     38"},{"value":"105792"}],[{"value":"    103"},{"value":"42265"}],[{"value":"    250"},{"value":"1512"}],[{"value":"     93"},{"value":"43732"}],[{"value":"     22"},{"value":"154809"}],[{"value":"    168"},{"value":"63868"}],[{"value":"    157"},{"value":"40426"}],[{"value":"     51"},{"value":"79347"}],[{"value":"     81"},{"value":"48081"}],[{"value":"    129"},{"value":"39373"}],[{"value":"    189"},{"value":"29649"}],[{"value":"    236"},{"value":"9118"}],[{"value":"     30"},{"value":"103117"}],[{"value":"    152"},{"value":"36810"}],[{"value":"    252"},{"value":"676"}],[{"value":"     20"},{"value":"145050"}],[{"value":"    166"},{"value":"66459"}],[{"value":"    208"},{"value":"23776"}],[{"value":"    238"},{"value":"10728"}],[{"value":"    245"},{"value":"4918"}],[{"value":"     98"},{"value":"42558"}],[{"value":"    121"},{"value":"38277"}],[{"value":"    193"},{"value":"28184"}],[{"value":"    190"},{"value":"24677"}],[{"value":"    173"},{"value":"54753"}],[{"value":"    219"},{"value":"15405"}],[{"value":"    165"},{"value":"74845"}],[{"value":"    130"},{"value":"38667"}],[{"value":"      9"},{"value":"177957"}],[{"value":"     55"},{"value":"60730"}],[{"value":"     87"},{"value":"43207"}],[{"value":"    221"},{"value":"15868"}]],"columnNames":[{"name":"antiguedad","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["     23","177839"],["    125","44840"],["    248","2271"],["    137","42125"],["     71","23884"],["    247","3516"],["     58","27872"],["     89","43522"],["    132","37756"],["    184","37326"],["    155","30901"],["     75","14452"],["     28","104820"],["    104","47069"],["     79","25547"],["     68","27920"],["    156","45711"],["    201","25223"],["     26","113488"],["    134","44164"],["    141","40247"],["    131","33914"],["    175","47404"],["    191","23170"],["    240","9036"],["     64","34156"],["    197","23276"],["      2","130259"],["     56","46126"],["    119","46804"],["    198","24273"],["     88","41999"],["     12","243160"],["    215","17517"],["    101","41775"],["    243","6514"],["     54","72079"],["    211","23119"],["      8","155703"],["    164","70881"],["     85","38358"],["     39","98125"],["     13","123990"],["     45","168847"],["     15","121716"],["      0","134484"],["    253","416"],["     16","135307"],["     19","118696"],["    171","59743"],["     67","26750"],["      6","127176"],["     91","39083"],["     95","41357"],["    116","42545"],["     70","24568"],["     33","174352"],["     14","126798"],["    203","18935"],["    174","55081"],["    230","10861"],["    142","40259"],["    117","55269"],["    146","38655"],["    229","11613"],["     60","22934"],["     21","214795"],["     29","102815"],["     61","28088"],["     41","99968"],["    122","38740"],["     65","29607"],["     59","24000"],["    218","17178"],["    254","261"],["     66","29860"],["    237","13165"],["    228","11920"],["    206","24321"],["    188","29274"],["    160","54189"],["    147","34702"],["    113","43487"],["     35","149736"],["    200","24366"],["    162","68136"],["     80","33806"],["    112","44902"],["    222","13614"],["    255","179"],["     27","107958"],["    108","45405"],["     97","42657"],["    148","36050"],["    106","43133"],["    124","42852"],["    153","37289"],["     90","42134"],["     34","147957"],["    220","16597"],["     32","139023"],["    209","23523"],["    107","46520"],["    154","33611"],["     17","125055"],["    199","25946"],["    224","13311"],["     47","123834"],["    127","41115"],["     77","24407"],["    100","38496"],["    183","32233"],["     73","19255"],["     63","34876"],["      4","127442"],["     62","31148"],["    170","61918"],["     18","125186"],["     50","85950"],["     53","82864"],["    178","44937"],["    225","14694"],["    180","44308"],["      7","129262"],["    212","22007"],["    115","43466"],["    167","52500"],["     NA","27734"],["     25","108448"],["    216","17884"],["    128","41646"],["     44","150837"],["     11","124718"],["     42","92558"],["    126","43989"],["    114","45440"],["    195","25666"],["    205","21667"],["    118","46059"],["    105","50504"],["    163","60463"],["     96","43555"],["     83","38632"],["    235","10836"],["      1","132579"],["    182","34677"],["    196","23627"],["     43","136555"],["    139","38921"],["    187","29438"],["     86","40718"],["     57","34772"],["    102","47575"],["    185","35841"],["    158","39484"],["    179","38597"],["    210","20742"],["    233","9198"],["    135","37274"],["    244","5928"],["    214","18696"],["     40","103485"],["    251","1071"],["    111","43661"],["     94","39945"],["    136","41000"],["    192","22947"],["    176","44779"],["    181","33532"],["     48","118825"],["     72","23631"],["     46","141724"],["     52","85728"],["    161","58927"],["     31","109500"],["     76","17565"],["    207","22095"],["    223","14827"],["    246","4591"],["    177","47797"],["     69","26134"],["    138","42286"],["     36","164425"],["    151","38502"],["     74","16021"],["     99","38017"],["    172","66085"],["    242","7425"],["-999999","38"],["    110","49349"],["    145","37074"],["    227","10426"],["     82","37311"],["    217","18326"],["    202","21995"],["     92","37944"],["    109","44028"],["    194","26804"],["    186","31362"],["    204","19416"],["    159","50979"],["    123","41074"],["     84","38932"],["    226","11554"],["    239","8056"],["    149","35193"],["      3","132745"],["    120","43559"],["    256","102"],["    140","40709"],["     78","25912"],["     10","206165"],["     37","100490"],["     49","85959"],["    232","11134"],["    169","65661"],["    241","8953"],["    143","37491"],["    133","38325"],["    213","19719"],["    144","38786"],["    231","13120"],["    234","10347"],["     24","167059"],["    249","1777"],["      5","139618"],["    150","37796"],["     38","105792"],["    103","42265"],["    250","1512"],["     93","43732"],["     22","154809"],["    168","63868"],["    157","40426"],["     51","79347"],["     81","48081"],["    129","39373"],["    189","29649"],["    236","9118"],["     30","103117"],["    152","36810"],["    252","676"],["     20","145050"],["    166","66459"],["    208","23776"],["    238","10728"],["    245","4918"],["     98","42558"],["    121","38277"],["    193","28184"],["    190","24677"],["    173","54753"],["    219","15405"],["    165","74845"],["    130","38667"],["      9","177957"],["     55","60730"],["     87","43207"],["    221","15868"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481276078418_1677949004","id":"20161209-043438_1355926068","dateCreated":"2016-12-09T04:34:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11407","dateUpdated":"2016-12-09T04:43:56-0500","dateFinished":"2016-12-09T04:43:57-0500","dateStarted":"2016-12-09T04:43:57-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Customer seniority column has 27,734 null values which are replaced with 0 in the following function</p>\n"},"text":"%md\nCustomer seniority column has 27,734 null values which are replaced with 0 in the following function"},{"text":"val cleanAntigaudad:(String => Int) = (antigaudad:String) => { antigaudad.replace(\" \",\"\") match {case \"NA\" => 0  case a => if(a.toInt > 0) a.toInt else 0}}\n\nval cleanAntigaudadUDF = udf(cleanAntigaudad)\n\nval newtrainData4 = newtrainData3.withColumn(\"newAntigaudad\", cleanAntigaudadUDF(col(\"antiguedad\")))\n\nnewTrainData4.toDF().registerTempTable(\"newData4\")","dateUpdated":"2016-12-09T04:34:35-0500","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12,"title":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480924845946_1668976762","id":"20161201-042711_552096001","dateCreated":"2016-12-05T03:00:45-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4361"},{"title":"Deceased Index","text":"%md\n### 6.Indfall(Deceased Index)","dateUpdated":"2016-12-09T04:38:44-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":false,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258367389_-1645720037","id":"20161208-233927_817922792","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>6.Indfall(Deceased Index)</h3>\n"},"dateCreated":"2016-12-08T23:39:27-0500","dateStarted":"2016-12-09T04:38:33-0500","dateFinished":"2016-12-09T04:38:33-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4362","focus":true},{"text":"%sql select indfall,count(*) from Data group by indfall","dateUpdated":"2016-12-09T04:43:08-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"indfall","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"indfall","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258450296_-1502838633","id":"20161208-234050_509359597","result":{"code":"SUCCESS","type":"TABLE","msg":"indfall\tcount(1)\nnull\t27734\nN\t13584813\nS\t34762\n","comment":"","msgTable":[[{"key":"count(1)","value":"null"},{"key":"count(1)","value":"27734"}],[{"value":"N"},{"value":"13584813"}],[{"value":"S"},{"value":"34762"}]],"columnNames":[{"name":"indfall","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["null","27734"],["N","13584813"],["S","34762"]]},"dateCreated":"2016-12-08T23:40:50-0500","dateStarted":"2016-12-09T04:40:42-0500","dateFinished":"2016-12-09T04:41:08-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11700"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481276437996_2030848589","id":"20161209-044037_48606971","dateCreated":"2016-12-09T04:40:37-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11571","dateUpdated":"2016-12-09T04:44:28-0500","dateFinished":"2016-12-09T04:43:12-0500","dateStarted":"2016-12-09T04:43:12-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Deceased Index column contains 27,734 null values which are split in ratio</p>\n"},"text":"%md\nDeceased Index column contains 27,734 null values which are split in approriate ratio"},{"text":"import org.apache.spark.sql.functions.udf\n\n\nval cleanIndfall:(String => String) = (indfall:String) => {\n                                                         val r1= new scala.util.Random\n                                                         indfall match {case null =>if(r1.nextFloat>0.71) \"N\" else \"S\" case a => a}}\n                                                         \nval cleanIndfalludf=udf(cleanIndfall)\n\nval newDataSet=trainData1.withColumn(\"newIndfall\",cleanIndfalludf(col(\"indfall\")))\n\n                                                \nnewDataSet.toDF().registerTempTable(\"newDataTable\")      ","dateUpdated":"2016-12-09T04:40:31-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258466502_742971345","id":"20161208-234106_2086717235","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleanIndfall: String => String = <function1>\n\ncleanIndfalludf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewDataSet: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"dateCreated":"2016-12-08T23:41:06-0500","dateStarted":"2016-12-09T00:12:53-0500","dateFinished":"2016-12-09T00:12:55-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4364"},{"text":"%sql select newIndfall,count(*) from newDataTable group by newIndfall","dateUpdated":"2016-12-09T04:40:26-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258503785_-783450135","id":"20161208-234143_1918476010","result":{"code":"SUCCESS","type":"TABLE","msg":"newIndfall\tcount(1)\nN\t13592783\nS\t54526\n","comment":"","msgTable":[[{"key":"count(1)","value":"N"},{"key":"count(1)","value":"13592783"}],[{"value":"S"},{"value":"54526"}]],"columnNames":[{"name":"newIndfall","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["N","13592783"],["S","54526"]]},"dateCreated":"2016-12-08T23:41:43-0500","dateStarted":"2016-12-09T00:12:59-0500","dateFinished":"2016-12-09T00:13:24-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4365"},{"title":"INDRESI","text":"%md\n### 7.Indresi (Residence Index )","dateUpdated":"2016-12-09T04:45:42-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":false,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258502647_-36267771","id":"20161208-234142_310604288","dateCreated":"2016-12-08T23:41:42-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4366","dateFinished":"2016-12-09T04:45:33-0500","dateStarted":"2016-12-09T04:45:33-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>7.Indresi (Residence Index )</h3>\n"},"focus":true},{"text":"%sql select indresi, count(*) from Data group by indresi","dateUpdated":"2016-12-09T00:18:37-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258482268_-1115735267","id":"20161208-234122_1783461732","result":{"code":"SUCCESS","type":"TABLE","msg":"indresi\tcount(1)\nnull\t27734\nN\t65864\nS\t13553711\n","comment":"","msgTable":[[{"key":"count(1)","value":"null"},{"key":"count(1)","value":"27734"}],[{"value":"N"},{"value":"65864"}],[{"value":"S"},{"value":"13553711"}]],"columnNames":[{"name":"indresi","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["null","27734"],["N","65864"],["S","13553711"]]},"dateCreated":"2016-12-08T23:41:22-0500","dateStarted":"2016-12-09T00:09:51-0500","dateFinished":"2016-12-09T00:10:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4367"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481276747125_580975171","id":"20161209-044547_1722547047","dateCreated":"2016-12-09T04:45:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11794","text":"%md\nColumn contains null of 27,734 null values which are split in ratio as in the previous step. ","dateUpdated":"2016-12-09T04:47:34-0500","dateFinished":"2016-12-09T04:47:30-0500","dateStarted":"2016-12-09T04:47:30-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Column contains null of 27,734 null values which are split in ratio as in the previous step.</p>\n"}},{"text":"import org.apache.spark.sql.functions.udf\n\n\nval cleanIndresi:(String => String) = (indresi:String) =>{\n                                                         val r1 = new scala.util.Random\n                                                         indresi match {case null =>if(r1.nextFloat>0.54) \"S\" else \"N\" case a => a}}\n                                                         \n                                                         \nval cleanIndresiudf = udf(cleanIndresi)\n\nval newData4 = trainData1.withColumn(\"newIndresi\", cleanIndresiudf(col(\"indresi\")))\n\nnewData4.toDF().registerTempTable(\"newTable4\")","dateUpdated":"2016-12-09T04:48:22-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258567920_-544277526","id":"20161208-234247_631847717","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleanIndresi: String => String = <function1>\n\ncleanIndresiudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData4: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"dateCreated":"2016-12-08T23:42:47-0500","dateStarted":"2016-12-09T00:13:41-0500","dateFinished":"2016-12-09T00:13:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4368"},{"text":"%sql select newIndresi,count(*) from newTable4 group by newIndresi","dateUpdated":"2016-12-09T04:48:22-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258583235_566523197","id":"20161208-234303_1726233882","result":{"code":"SUCCESS","type":"TABLE","msg":"newInd\tcount(1)\nN\t80906\nS\t13566403\n","comment":"","msgTable":[[{"key":"count(1)","value":"N"},{"key":"count(1)","value":"80906"}],[{"value":"S"},{"value":"13566403"}]],"columnNames":[{"name":"newInd","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["N","80906"],["S","13566403"]]},"dateCreated":"2016-12-08T23:43:03-0500","dateStarted":"2016-12-09T00:13:47-0500","dateFinished":"2016-12-09T00:14:12-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4369"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481276902672_-1355619285","id":"20161209-044822_1198006359","dateCreated":"2016-12-09T04:48:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11882","text":"%md\n### 8.indrel_1mes (Customer type at the begining of the month)","dateUpdated":"2016-12-09T04:50:42-0500","dateFinished":"2016-12-09T04:50:37-0500","dateStarted":"2016-12-09T04:50:37-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>8.indrel_1mes (Customer type at the begining of the month)</h3>\n"}},{"text":"%sql select indrel_1mes,count(*) from Data group by indrel_1mes","dateUpdated":"2016-12-09T04:50:47-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481258595834_-919761804","id":"20161208-234315_1830159511","result":{"code":"SUCCESS","type":"TABLE","msg":"indrel_1mes\tcount(1)\n1.0\t9133383\n3\t1570\nnull\t149781\n4.0\t223\n2.0\t740\n1\t4357298\nP\t874\n4\t83\n3.0\t2780\n2\t577\n","comment":"","msgTable":[[{"key":"count(1)","value":"1.0"},{"key":"count(1)","value":"9133383"}],[{"value":"3"},{"value":"1570"}],[{"value":"null"},{"value":"149781"}],[{"value":"4.0"},{"value":"223"}],[{"value":"2.0"},{"value":"740"}],[{"value":"1"},{"value":"4357298"}],[{"value":"P"},{"value":"874"}],[{"value":"4"},{"value":"83"}],[{"value":"3.0"},{"value":"2780"}],[{"value":"2"},{"value":"577"}]],"columnNames":[{"name":"indrel_1mes","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["1.0","9133383"],["3","1570"],["null","149781"],["4.0","223"],["2.0","740"],["1","4357298"],["P","874"],["4","83"],["3.0","2780"],["2","577"]]},"dateCreated":"2016-12-08T23:43:15-0500","dateStarted":"2016-12-09T00:15:09-0500","dateFinished":"2016-12-09T00:15:32-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4370"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277050552_-1406407784","id":"20161209-045050_225170190","dateCreated":"2016-12-09T04:50:50-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11967","text":"The null values are replaced by 0","dateUpdated":"2016-12-09T04:52:48-0500"},{"text":"val cleanindrel:(String => String) = (indrel:String) => {indrel match {case null => \"UNKNOWN\" case \"P\" => \"P\" case a => a.toDouble.toInt.toString}}\n\nval cleanindreludf = udf(cleanindrel)\n\nval newData6 = trainData1.withColumn(\"newindrel\", cleanindreludf(col(\"indrel_1mes\")))\n\nnewData6.toDF().registerTempTable(\"newTable6\")","dateUpdated":"2016-12-09T04:53:46-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481260509230_-715037410","id":"20161209-001509_1941759384","result":{"code":"SUCCESS","type":"TEXT","msg":"\ncleanindrel: String => String = <function1>\n\ncleanindreludf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData6: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"dateCreated":"2016-12-09T00:15:09-0500","dateStarted":"2016-12-09T04:53:46-0500","dateFinished":"2016-12-09T04:53:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4371","focus":true},{"text":"%sql select newindrel,count(*) from newTable6 group by newindrel","dateUpdated":"2016-12-09T04:53:51-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481261190687_210248113","id":"20161209-002630_1707195185","result":{"code":"SUCCESS","type":"TABLE","msg":"newindrel\tcount(1)\n3\t4350\nUNKNOWN\t149781\n1\t13490681\nP\t874\n4\t306\n2\t1317\n","comment":"","msgTable":[[{"key":"count(1)","value":"3"},{"key":"count(1)","value":"4350"}],[{"value":"UNKNOWN"},{"value":"149781"}],[{"value":"1"},{"value":"13490681"}],[{"value":"P"},{"value":"874"}],[{"value":"4"},{"value":"306"}],[{"value":"2"},{"value":"1317"}]],"columnNames":[{"name":"newindrel","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["3","4350"],["UNKNOWN","149781"],["1","13490681"],["P","874"],["4","306"],["2","1317"]]},"dateCreated":"2016-12-09T00:26:30-0500","dateStarted":"2016-12-09T04:53:51-0500","dateFinished":"2016-12-09T04:54:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4372","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481271569858_-781217060","id":"20161209-031929_740270952","dateCreated":"2016-12-09T03:19:29-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8747","dateUpdated":"2016-12-09T04:56:55-0500","dateFinished":"2016-12-09T04:56:55-0500","dateStarted":"2016-12-09T04:56:55-0500","title":"","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>9.INDEXT (Foriegner Index)</h3>\n"},"text":"%md\n### 9.INDEXT (Foriegner Index)"},{"text":"%sql select indext,count(*) from Data group by indext","dateUpdated":"2016-12-09T04:57:38-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481262945834_-1426744086","id":"20161209-005545_769693294","result":{"code":"SUCCESS","type":"TABLE","msg":"indext\tcount(1)\nnull\t27734\nN\t12974839\nS\t644736\n","comment":"","msgTable":[[{"key":"count(1)","value":"null"},{"key":"count(1)","value":"27734"}],[{"value":"N"},{"value":"12974839"}],[{"value":"S"},{"value":"644736"}]],"columnNames":[{"name":"indext","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["null","27734"],["N","12974839"],["S","644736"]]},"dateCreated":"2016-12-09T00:55:45-0500","dateStarted":"2016-12-09T01:18:15-0500","dateFinished":"2016-12-09T01:18:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4373","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277422284_-730173809","id":"20161209-045702_162530314","dateCreated":"2016-12-09T04:57:02-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12095","text":"%md \n27,734 null values split in approriate ratio","dateUpdated":"2016-12-09T04:58:42-0500","dateFinished":"2016-12-09T04:58:39-0500","dateStarted":"2016-12-09T04:58:39-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>27,734 null values split in approriate ratio</p>\n"}},{"text":"import org.apache.spark.sql.functions.udf\n\nval cleanIndext:(String=>String) = (indext:String)=>{ val r= new scala.util.Random\n                                                     indext match {case null =>if(r.nextFloat>0.66) \"N\" else \"S\" case a => a}}\n                                                     \n                                                    \nval cleanIndextudf=udf(cleanIndext)\n\nval newData7 = trainData1.withColumn(\"newIndext\", cleanIndextudf(col(\"indext\"))).drop(\"indext\")\n\nnewData7.toDF().registerTempTable(\"newTable7\")","dateUpdated":"2016-12-09T03:19:52-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481263143985_-1954175176","id":"20161209-005903_1576449709","dateCreated":"2016-12-09T00:59:03-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4374","dateFinished":"2016-12-09T01:48:36-0500","dateStarted":"2016-12-09T01:48:35-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleanIndext: String => String = <function1>\n\ncleanIndextudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData7: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 46 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481264662102_1931210209","id":"20161209-012422_1480317944","dateCreated":"2016-12-09T01:24:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7353","dateUpdated":"2016-12-09T01:48:50-0500","dateFinished":"2016-12-09T01:31:29-0500","dateStarted":"2016-12-09T01:31:04-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"newIndext\tcount(1)\nN\t12984231\nS\t663078\n","comment":"","msgTable":[[{"key":"count(1)","value":"N"},{"key":"count(1)","value":"12984231"}],[{"value":"S"},{"value":"663078"}]],"columnNames":[{"name":"newIndext","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["N","12984231"],["S","663078"]]},"text":"%sql select newIndext,count(*) from newTable7 group by newIndext"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":false,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481271600684_-1629542412","id":"20161209-032000_642789543","dateCreated":"2016-12-09T03:20:00-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8846","dateUpdated":"2016-12-09T04:59:54-0500","dateFinished":"2016-12-09T04:59:54-0500","dateStarted":"2016-12-09T04:59:54-0500","title":"CANAL ENTRADA","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>10.Canal_Entrada (Channel of joning)</h3>\n"},"text":"%md\n### 10.Canal_Entrada (Channel of joning)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481265616443_754043852","id":"20161209-014016_1498674576","dateCreated":"2016-12-09T01:40:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7630","dateUpdated":"2016-12-09T05:00:12-0500","dateFinished":"2016-12-09T01:50:31-0500","dateStarted":"2016-12-09T01:50:06-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"canal_entrada\tcount(1)\nKEB\t370\nKAT\t3268209\nKHK\t241084\nRED\t75607\nKFI\t881\nKCO\t179\nKFG\t6800\nKEA\t851\nKBV\t896\nKHE\t4055270\nKAG\t74295\nKAB\t62381\nKBY\t642\nKCH\t24098\nKHL\t45128\nKCC\t49308\nKAH\t24875\nKDS\t1924\nKFD\t44461\nKAL\t7573\nKEZ\t2433\nKBH\t7197\nKFS\t6694\nKDM\t2468\nKEC\t231\n013\t27139\nKBX\t102\nKCX\t67\nKGY\t4138\nKDU\t2588\nKED\t3011\nnull\t186126\nKAM\t11285\nKHS\t5\nKEU\t265\nKFK\t3913\nK00\t152\nKEQ\t146\nKHA\t51\nKFN\t4520\nKDC\t1531\nKAO\t6676\nKAI\t37699\nKHD\t116891\nKAF\t30559\nKFH\t2579\nKEW\t5687\nKDA\t379\nKAW\t34275\nKFA\t409669\nKHO\t8992\nKBB\t1298\nKBO\t7380\nKBL\t575\nKDN\t197\nKAU\t249\nKCS\t236\nKCK\t957\nKEV\t844\nKHQ\t591039\nKCI\t26546\nKFT\t8036\nKDZ\t531\nKFV\t67\nKGW\t989\nKCR\t196\nKFE\t250\nKEK\t542\n025\t11\nKDF\t726\nKAR\t32686\nKEI\t944\nKBF\t3760\nKES\t5904\nKFC\t3098360\nKCL\t4187\nKDB\t17\nKAC\t7697\nKBJ\t519\nKAJ\t24280\nKCP\t158\nKGV\t8950\nKDT\t1299\nKEE\t175\nKCJ\t215\nKHP\t691\nKFF\t5529\nKEJ\t9247\nKDP\t1001\nKAV\t107\nKAK\t838\nKCB\t5187\nKGC\t28\nKBG\t1725\nKDD\t534\nKCU\t1081\nKCM\t3251\nKAN\t1370\nKBS\t714\nKCN\t1117\nKDI\t17\nKEM\t68\nKDL\t11\nKBQ\t4179\nKBD\t241\nKBW\t1130\nKFJ\t6620\nKAE\t50764\nKDW\t772\nKEY\t35146\nKDY\t1960\nKCD\t3276\nKDO\t1763\nKDQ\t1112\nKEG\t1895\nKFU\t4914\nKDX\t1728\nKCE\t309\nKBN\t61\nKEO\t850\nKEN\t4917\nKFR\t371\nKHC\t16418\nKEH\t1546\nKAP\t14928\nKHF\t20674\nKGU\t28\nKAQ\t18017\nKAS\t86221\nKCT\t105\nKBU\t3127\n004\t210\nKDR\t8050\nKBP\t85\nKDG\t469\nKBM\t555\nKDH\t191\nKAA\t66656\nKAZ\t32186\nKGX\t9474\nKAD\t10680\nKFP\t9487\nKFB\t107\nKHM\t183924\nKCF\t420\nKEF\t329\nKHN\t116608\nKCG\t5399\nKGN\t17\n007\t29063\nKBR\t1875\nKFM\t371\nKCQ\t198\nKCV\t229\nKHR\t1\nKDE\t828\nKAY\t67350\nKEL\t2483\nKFL\t3806\nKBZ\t46446\nKBE\t147\nKCA\t1530\nKDV\t427\n","comment":"","msgTable":[[{"key":"count(1)","value":"KEB"},{"key":"count(1)","value":"370"}],[{"value":"KAT"},{"value":"3268209"}],[{"value":"KHK"},{"value":"241084"}],[{"value":"RED"},{"value":"75607"}],[{"value":"KFI"},{"value":"881"}],[{"value":"KCO"},{"value":"179"}],[{"value":"KFG"},{"value":"6800"}],[{"value":"KEA"},{"value":"851"}],[{"value":"KBV"},{"value":"896"}],[{"value":"KHE"},{"value":"4055270"}],[{"value":"KAG"},{"value":"74295"}],[{"value":"KAB"},{"value":"62381"}],[{"value":"KBY"},{"value":"642"}],[{"value":"KCH"},{"value":"24098"}],[{"value":"KHL"},{"value":"45128"}],[{"value":"KCC"},{"value":"49308"}],[{"value":"KAH"},{"value":"24875"}],[{"value":"KDS"},{"value":"1924"}],[{"value":"KFD"},{"value":"44461"}],[{"value":"KAL"},{"value":"7573"}],[{"value":"KEZ"},{"value":"2433"}],[{"value":"KBH"},{"value":"7197"}],[{"value":"KFS"},{"value":"6694"}],[{"value":"KDM"},{"value":"2468"}],[{"value":"KEC"},{"value":"231"}],[{"value":"013"},{"value":"27139"}],[{"value":"KBX"},{"value":"102"}],[{"value":"KCX"},{"value":"67"}],[{"value":"KGY"},{"value":"4138"}],[{"value":"KDU"},{"value":"2588"}],[{"value":"KED"},{"value":"3011"}],[{"value":"null"},{"value":"186126"}],[{"value":"KAM"},{"value":"11285"}],[{"value":"KHS"},{"value":"5"}],[{"value":"KEU"},{"value":"265"}],[{"value":"KFK"},{"value":"3913"}],[{"value":"K00"},{"value":"152"}],[{"value":"KEQ"},{"value":"146"}],[{"value":"KHA"},{"value":"51"}],[{"value":"KFN"},{"value":"4520"}],[{"value":"KDC"},{"value":"1531"}],[{"value":"KAO"},{"value":"6676"}],[{"value":"KAI"},{"value":"37699"}],[{"value":"KHD"},{"value":"116891"}],[{"value":"KAF"},{"value":"30559"}],[{"value":"KFH"},{"value":"2579"}],[{"value":"KEW"},{"value":"5687"}],[{"value":"KDA"},{"value":"379"}],[{"value":"KAW"},{"value":"34275"}],[{"value":"KFA"},{"value":"409669"}],[{"value":"KHO"},{"value":"8992"}],[{"value":"KBB"},{"value":"1298"}],[{"value":"KBO"},{"value":"7380"}],[{"value":"KBL"},{"value":"575"}],[{"value":"KDN"},{"value":"197"}],[{"value":"KAU"},{"value":"249"}],[{"value":"KCS"},{"value":"236"}],[{"value":"KCK"},{"value":"957"}],[{"value":"KEV"},{"value":"844"}],[{"value":"KHQ"},{"value":"591039"}],[{"value":"KCI"},{"value":"26546"}],[{"value":"KFT"},{"value":"8036"}],[{"value":"KDZ"},{"value":"531"}],[{"value":"KFV"},{"value":"67"}],[{"value":"KGW"},{"value":"989"}],[{"value":"KCR"},{"value":"196"}],[{"value":"KFE"},{"value":"250"}],[{"value":"KEK"},{"value":"542"}],[{"value":"025"},{"value":"11"}],[{"value":"KDF"},{"value":"726"}],[{"value":"KAR"},{"value":"32686"}],[{"value":"KEI"},{"value":"944"}],[{"value":"KBF"},{"value":"3760"}],[{"value":"KES"},{"value":"5904"}],[{"value":"KFC"},{"value":"3098360"}],[{"value":"KCL"},{"value":"4187"}],[{"value":"KDB"},{"value":"17"}],[{"value":"KAC"},{"value":"7697"}],[{"value":"KBJ"},{"value":"519"}],[{"value":"KAJ"},{"value":"24280"}],[{"value":"KCP"},{"value":"158"}],[{"value":"KGV"},{"value":"8950"}],[{"value":"KDT"},{"value":"1299"}],[{"value":"KEE"},{"value":"175"}],[{"value":"KCJ"},{"value":"215"}],[{"value":"KHP"},{"value":"691"}],[{"value":"KFF"},{"value":"5529"}],[{"value":"KEJ"},{"value":"9247"}],[{"value":"KDP"},{"value":"1001"}],[{"value":"KAV"},{"value":"107"}],[{"value":"KAK"},{"value":"838"}],[{"value":"KCB"},{"value":"5187"}],[{"value":"KGC"},{"value":"28"}],[{"value":"KBG"},{"value":"1725"}],[{"value":"KDD"},{"value":"534"}],[{"value":"KCU"},{"value":"1081"}],[{"value":"KCM"},{"value":"3251"}],[{"value":"KAN"},{"value":"1370"}],[{"value":"KBS"},{"value":"714"}],[{"value":"KCN"},{"value":"1117"}],[{"value":"KDI"},{"value":"17"}],[{"value":"KEM"},{"value":"68"}],[{"value":"KDL"},{"value":"11"}],[{"value":"KBQ"},{"value":"4179"}],[{"value":"KBD"},{"value":"241"}],[{"value":"KBW"},{"value":"1130"}],[{"value":"KFJ"},{"value":"6620"}],[{"value":"KAE"},{"value":"50764"}],[{"value":"KDW"},{"value":"772"}],[{"value":"KEY"},{"value":"35146"}],[{"value":"KDY"},{"value":"1960"}],[{"value":"KCD"},{"value":"3276"}],[{"value":"KDO"},{"value":"1763"}],[{"value":"KDQ"},{"value":"1112"}],[{"value":"KEG"},{"value":"1895"}],[{"value":"KFU"},{"value":"4914"}],[{"value":"KDX"},{"value":"1728"}],[{"value":"KCE"},{"value":"309"}],[{"value":"KBN"},{"value":"61"}],[{"value":"KEO"},{"value":"850"}],[{"value":"KEN"},{"value":"4917"}],[{"value":"KFR"},{"value":"371"}],[{"value":"KHC"},{"value":"16418"}],[{"value":"KEH"},{"value":"1546"}],[{"value":"KAP"},{"value":"14928"}],[{"value":"KHF"},{"value":"20674"}],[{"value":"KGU"},{"value":"28"}],[{"value":"KAQ"},{"value":"18017"}],[{"value":"KAS"},{"value":"86221"}],[{"value":"KCT"},{"value":"105"}],[{"value":"KBU"},{"value":"3127"}],[{"value":"004"},{"value":"210"}],[{"value":"KDR"},{"value":"8050"}],[{"value":"KBP"},{"value":"85"}],[{"value":"KDG"},{"value":"469"}],[{"value":"KBM"},{"value":"555"}],[{"value":"KDH"},{"value":"191"}],[{"value":"KAA"},{"value":"66656"}],[{"value":"KAZ"},{"value":"32186"}],[{"value":"KGX"},{"value":"9474"}],[{"value":"KAD"},{"value":"10680"}],[{"value":"KFP"},{"value":"9487"}],[{"value":"KFB"},{"value":"107"}],[{"value":"KHM"},{"value":"183924"}],[{"value":"KCF"},{"value":"420"}],[{"value":"KEF"},{"value":"329"}],[{"value":"KHN"},{"value":"116608"}],[{"value":"KCG"},{"value":"5399"}],[{"value":"KGN"},{"value":"17"}],[{"value":"007"},{"value":"29063"}],[{"value":"KBR"},{"value":"1875"}],[{"value":"KFM"},{"value":"371"}],[{"value":"KCQ"},{"value":"198"}],[{"value":"KCV"},{"value":"229"}],[{"value":"KHR"},{"value":"1"}],[{"value":"KDE"},{"value":"828"}],[{"value":"KAY"},{"value":"67350"}],[{"value":"KEL"},{"value":"2483"}],[{"value":"KFL"},{"value":"3806"}],[{"value":"KBZ"},{"value":"46446"}],[{"value":"KBE"},{"value":"147"}],[{"value":"KCA"},{"value":"1530"}],[{"value":"KDV"},{"value":"427"}]],"columnNames":[{"name":"canal_entrada","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["KEB","370"],["KAT","3268209"],["KHK","241084"],["RED","75607"],["KFI","881"],["KCO","179"],["KFG","6800"],["KEA","851"],["KBV","896"],["KHE","4055270"],["KAG","74295"],["KAB","62381"],["KBY","642"],["KCH","24098"],["KHL","45128"],["KCC","49308"],["KAH","24875"],["KDS","1924"],["KFD","44461"],["KAL","7573"],["KEZ","2433"],["KBH","7197"],["KFS","6694"],["KDM","2468"],["KEC","231"],["013","27139"],["KBX","102"],["KCX","67"],["KGY","4138"],["KDU","2588"],["KED","3011"],["null","186126"],["KAM","11285"],["KHS","5"],["KEU","265"],["KFK","3913"],["K00","152"],["KEQ","146"],["KHA","51"],["KFN","4520"],["KDC","1531"],["KAO","6676"],["KAI","37699"],["KHD","116891"],["KAF","30559"],["KFH","2579"],["KEW","5687"],["KDA","379"],["KAW","34275"],["KFA","409669"],["KHO","8992"],["KBB","1298"],["KBO","7380"],["KBL","575"],["KDN","197"],["KAU","249"],["KCS","236"],["KCK","957"],["KEV","844"],["KHQ","591039"],["KCI","26546"],["KFT","8036"],["KDZ","531"],["KFV","67"],["KGW","989"],["KCR","196"],["KFE","250"],["KEK","542"],["025","11"],["KDF","726"],["KAR","32686"],["KEI","944"],["KBF","3760"],["KES","5904"],["KFC","3098360"],["KCL","4187"],["KDB","17"],["KAC","7697"],["KBJ","519"],["KAJ","24280"],["KCP","158"],["KGV","8950"],["KDT","1299"],["KEE","175"],["KCJ","215"],["KHP","691"],["KFF","5529"],["KEJ","9247"],["KDP","1001"],["KAV","107"],["KAK","838"],["KCB","5187"],["KGC","28"],["KBG","1725"],["KDD","534"],["KCU","1081"],["KCM","3251"],["KAN","1370"],["KBS","714"],["KCN","1117"],["KDI","17"],["KEM","68"],["KDL","11"],["KBQ","4179"],["KBD","241"],["KBW","1130"],["KFJ","6620"],["KAE","50764"],["KDW","772"],["KEY","35146"],["KDY","1960"],["KCD","3276"],["KDO","1763"],["KDQ","1112"],["KEG","1895"],["KFU","4914"],["KDX","1728"],["KCE","309"],["KBN","61"],["KEO","850"],["KEN","4917"],["KFR","371"],["KHC","16418"],["KEH","1546"],["KAP","14928"],["KHF","20674"],["KGU","28"],["KAQ","18017"],["KAS","86221"],["KCT","105"],["KBU","3127"],["004","210"],["KDR","8050"],["KBP","85"],["KDG","469"],["KBM","555"],["KDH","191"],["KAA","66656"],["KAZ","32186"],["KGX","9474"],["KAD","10680"],["KFP","9487"],["KFB","107"],["KHM","183924"],["KCF","420"],["KEF","329"],["KHN","116608"],["KCG","5399"],["KGN","17"],["007","29063"],["KBR","1875"],["KFM","371"],["KCQ","198"],["KCV","229"],["KHR","1"],["KDE","828"],["KAY","67350"],["KEL","2483"],["KFL","3806"],["KBZ","46446"],["KBE","147"],["KCA","1530"],["KDV","427"]]},"text":"%sql select canal_entrada,count(*) from newTable7 group by canal_entrada\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277615224_217537708","id":"20161209-050015_475023224","dateCreated":"2016-12-09T05:00:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12227","text":"%md\nnull and invalid values are replaced with zero","dateUpdated":"2016-12-09T05:01:09-0500","dateFinished":"2016-12-09T05:01:09-0500","dateStarted":"2016-12-09T05:01:09-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>null and invalid values are replaced with zero</p>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481266206320_-111249847","id":"20161209-015006_1493335344","dateCreated":"2016-12-09T01:50:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7751","dateUpdated":"2016-12-09T05:00:04-0500","dateFinished":"2016-12-09T02:10:00-0500","dateStarted":"2016-12-09T02:09:58-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleancanal: String => String = <function1>\n\ncleancanaludf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData8: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"text":"import org.apache.spark.sql.functions.udf\nval cleancanal:(String=>String) = (canal:String)=>{ //val r= new scala.util.Random\n                                                     canal match {case null =>\"0\" case \"13\" => \"0\" case \"4\"=>\"0\" case \"7\"=>\"0\" case a => a.toString}}\n                                                     \nval cleancanaludf=udf(cleancanal)\n\nval newData8 = trainData1.withColumn(\"newCanal\", cleancanaludf(col(\"canal_entrada\")))\n\nnewData8.toDF.registerTempTable(\"newTable8\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"newCanal","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"newCanal","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481266673725_-1309650725","id":"20161209-015753_1928325934","dateCreated":"2016-12-09T01:57:53-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7859","dateUpdated":"2016-12-09T02:11:00-0500","dateFinished":"2016-12-09T02:11:26-0500","dateStarted":"2016-12-09T02:11:00-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"newCanal\tcount(1)\nKEB\t370\nKAT\t3268209\nKHK\t241084\nRED\t75607\nKFI\t881\nKCO\t179\nKFG\t6800\nKEA\t851\nKBV\t896\nKHE\t4055270\nKAG\t74295\nKAB\t62381\nKBY\t642\nKCH\t24098\nKHL\t45128\nKCC\t49308\nKAH\t24875\nKDS\t1924\nKFD\t44461\nKAL\t7573\nKEZ\t2433\nKBH\t7197\nKFS\t6694\nKDM\t2468\nKEC\t231\n0\t186126\n013\t27139\nKBX\t102\nKCX\t67\nKGY\t4138\nKDU\t2588\nKED\t3011\nKAM\t11285\nKHS\t5\nKEU\t265\nKFK\t3913\nK00\t152\nKEQ\t146\nKHA\t51\nKFN\t4520\nKDC\t1531\nKAO\t6676\nKAI\t37699\nKHD\t116891\nKAF\t30559\nKFH\t2579\nKEW\t5687\nKDA\t379\nKAW\t34275\nKFA\t409669\nKHO\t8992\nKBB\t1298\nKBO\t7380\nKBL\t575\nKDN\t197\nKAU\t249\nKCS\t236\nKCK\t957\nKEV\t844\nKHQ\t591039\nKCI\t26546\nKFT\t8036\nKDZ\t531\nKFV\t67\nKGW\t989\nKCR\t196\nKFE\t250\nKEK\t542\n025\t11\nKDF\t726\nKAR\t32686\nKEI\t944\nKBF\t3760\nKES\t5904\nKFC\t3098360\nKCL\t4187\nKDB\t17\nKAC\t7697\nKBJ\t519\nKAJ\t24280\nKCP\t158\nKGV\t8950\nKDT\t1299\nKEE\t175\nKCJ\t215\nKHP\t691\nKFF\t5529\nKEJ\t9247\nKDP\t1001\nKAV\t107\nKAK\t838\nKCB\t5187\nKGC\t28\nKBG\t1725\nKDD\t534\nKCU\t1081\nKCM\t3251\nKAN\t1370\nKBS\t714\nKCN\t1117\nKDI\t17\nKEM\t68\nKDL\t11\nKBQ\t4179\nKBD\t241\nKBW\t1130\nKFJ\t6620\nKAE\t50764\nKDW\t772\nKEY\t35146\nKDY\t1960\nKCD\t3276\nKDO\t1763\nKDQ\t1112\nKEG\t1895\nKFU\t4914\nKDX\t1728\nKCE\t309\nKBN\t61\nKEO\t850\nKEN\t4917\nKFR\t371\nKHC\t16418\nKEH\t1546\nKAP\t14928\nKHF\t20674\nKGU\t28\nKAQ\t18017\nKAS\t86221\nKCT\t105\nKBU\t3127\n004\t210\nKDR\t8050\nKBP\t85\nKDG\t469\nKBM\t555\nKDH\t191\nKAA\t66656\nKAZ\t32186\nKGX\t9474\nKAD\t10680\nKFP\t9487\nKFB\t107\nKHM\t183924\nKCF\t420\nKEF\t329\nKHN\t116608\nKCG\t5399\nKGN\t17\n007\t29063\nKBR\t1875\nKFM\t371\nKCQ\t198\nKCV\t229\nKHR\t1\nKDE\t828\nKAY\t67350\nKEL\t2483\nKFL\t3806\nKBZ\t46446\nKBE\t147\nKCA\t1530\nKDV\t427\n","comment":"","msgTable":[[{"key":"count(1)","value":"KEB"},{"key":"count(1)","value":"370"}],[{"value":"KAT"},{"value":"3268209"}],[{"value":"KHK"},{"value":"241084"}],[{"value":"RED"},{"value":"75607"}],[{"value":"KFI"},{"value":"881"}],[{"value":"KCO"},{"value":"179"}],[{"value":"KFG"},{"value":"6800"}],[{"value":"KEA"},{"value":"851"}],[{"value":"KBV"},{"value":"896"}],[{"value":"KHE"},{"value":"4055270"}],[{"value":"KAG"},{"value":"74295"}],[{"value":"KAB"},{"value":"62381"}],[{"value":"KBY"},{"value":"642"}],[{"value":"KCH"},{"value":"24098"}],[{"value":"KHL"},{"value":"45128"}],[{"value":"KCC"},{"value":"49308"}],[{"value":"KAH"},{"value":"24875"}],[{"value":"KDS"},{"value":"1924"}],[{"value":"KFD"},{"value":"44461"}],[{"value":"KAL"},{"value":"7573"}],[{"value":"KEZ"},{"value":"2433"}],[{"value":"KBH"},{"value":"7197"}],[{"value":"KFS"},{"value":"6694"}],[{"value":"KDM"},{"value":"2468"}],[{"value":"KEC"},{"value":"231"}],[{"value":"0"},{"value":"186126"}],[{"value":"013"},{"value":"27139"}],[{"value":"KBX"},{"value":"102"}],[{"value":"KCX"},{"value":"67"}],[{"value":"KGY"},{"value":"4138"}],[{"value":"KDU"},{"value":"2588"}],[{"value":"KED"},{"value":"3011"}],[{"value":"KAM"},{"value":"11285"}],[{"value":"KHS"},{"value":"5"}],[{"value":"KEU"},{"value":"265"}],[{"value":"KFK"},{"value":"3913"}],[{"value":"K00"},{"value":"152"}],[{"value":"KEQ"},{"value":"146"}],[{"value":"KHA"},{"value":"51"}],[{"value":"KFN"},{"value":"4520"}],[{"value":"KDC"},{"value":"1531"}],[{"value":"KAO"},{"value":"6676"}],[{"value":"KAI"},{"value":"37699"}],[{"value":"KHD"},{"value":"116891"}],[{"value":"KAF"},{"value":"30559"}],[{"value":"KFH"},{"value":"2579"}],[{"value":"KEW"},{"value":"5687"}],[{"value":"KDA"},{"value":"379"}],[{"value":"KAW"},{"value":"34275"}],[{"value":"KFA"},{"value":"409669"}],[{"value":"KHO"},{"value":"8992"}],[{"value":"KBB"},{"value":"1298"}],[{"value":"KBO"},{"value":"7380"}],[{"value":"KBL"},{"value":"575"}],[{"value":"KDN"},{"value":"197"}],[{"value":"KAU"},{"value":"249"}],[{"value":"KCS"},{"value":"236"}],[{"value":"KCK"},{"value":"957"}],[{"value":"KEV"},{"value":"844"}],[{"value":"KHQ"},{"value":"591039"}],[{"value":"KCI"},{"value":"26546"}],[{"value":"KFT"},{"value":"8036"}],[{"value":"KDZ"},{"value":"531"}],[{"value":"KFV"},{"value":"67"}],[{"value":"KGW"},{"value":"989"}],[{"value":"KCR"},{"value":"196"}],[{"value":"KFE"},{"value":"250"}],[{"value":"KEK"},{"value":"542"}],[{"value":"025"},{"value":"11"}],[{"value":"KDF"},{"value":"726"}],[{"value":"KAR"},{"value":"32686"}],[{"value":"KEI"},{"value":"944"}],[{"value":"KBF"},{"value":"3760"}],[{"value":"KES"},{"value":"5904"}],[{"value":"KFC"},{"value":"3098360"}],[{"value":"KCL"},{"value":"4187"}],[{"value":"KDB"},{"value":"17"}],[{"value":"KAC"},{"value":"7697"}],[{"value":"KBJ"},{"value":"519"}],[{"value":"KAJ"},{"value":"24280"}],[{"value":"KCP"},{"value":"158"}],[{"value":"KGV"},{"value":"8950"}],[{"value":"KDT"},{"value":"1299"}],[{"value":"KEE"},{"value":"175"}],[{"value":"KCJ"},{"value":"215"}],[{"value":"KHP"},{"value":"691"}],[{"value":"KFF"},{"value":"5529"}],[{"value":"KEJ"},{"value":"9247"}],[{"value":"KDP"},{"value":"1001"}],[{"value":"KAV"},{"value":"107"}],[{"value":"KAK"},{"value":"838"}],[{"value":"KCB"},{"value":"5187"}],[{"value":"KGC"},{"value":"28"}],[{"value":"KBG"},{"value":"1725"}],[{"value":"KDD"},{"value":"534"}],[{"value":"KCU"},{"value":"1081"}],[{"value":"KCM"},{"value":"3251"}],[{"value":"KAN"},{"value":"1370"}],[{"value":"KBS"},{"value":"714"}],[{"value":"KCN"},{"value":"1117"}],[{"value":"KDI"},{"value":"17"}],[{"value":"KEM"},{"value":"68"}],[{"value":"KDL"},{"value":"11"}],[{"value":"KBQ"},{"value":"4179"}],[{"value":"KBD"},{"value":"241"}],[{"value":"KBW"},{"value":"1130"}],[{"value":"KFJ"},{"value":"6620"}],[{"value":"KAE"},{"value":"50764"}],[{"value":"KDW"},{"value":"772"}],[{"value":"KEY"},{"value":"35146"}],[{"value":"KDY"},{"value":"1960"}],[{"value":"KCD"},{"value":"3276"}],[{"value":"KDO"},{"value":"1763"}],[{"value":"KDQ"},{"value":"1112"}],[{"value":"KEG"},{"value":"1895"}],[{"value":"KFU"},{"value":"4914"}],[{"value":"KDX"},{"value":"1728"}],[{"value":"KCE"},{"value":"309"}],[{"value":"KBN"},{"value":"61"}],[{"value":"KEO"},{"value":"850"}],[{"value":"KEN"},{"value":"4917"}],[{"value":"KFR"},{"value":"371"}],[{"value":"KHC"},{"value":"16418"}],[{"value":"KEH"},{"value":"1546"}],[{"value":"KAP"},{"value":"14928"}],[{"value":"KHF"},{"value":"20674"}],[{"value":"KGU"},{"value":"28"}],[{"value":"KAQ"},{"value":"18017"}],[{"value":"KAS"},{"value":"86221"}],[{"value":"KCT"},{"value":"105"}],[{"value":"KBU"},{"value":"3127"}],[{"value":"004"},{"value":"210"}],[{"value":"KDR"},{"value":"8050"}],[{"value":"KBP"},{"value":"85"}],[{"value":"KDG"},{"value":"469"}],[{"value":"KBM"},{"value":"555"}],[{"value":"KDH"},{"value":"191"}],[{"value":"KAA"},{"value":"66656"}],[{"value":"KAZ"},{"value":"32186"}],[{"value":"KGX"},{"value":"9474"}],[{"value":"KAD"},{"value":"10680"}],[{"value":"KFP"},{"value":"9487"}],[{"value":"KFB"},{"value":"107"}],[{"value":"KHM"},{"value":"183924"}],[{"value":"KCF"},{"value":"420"}],[{"value":"KEF"},{"value":"329"}],[{"value":"KHN"},{"value":"116608"}],[{"value":"KCG"},{"value":"5399"}],[{"value":"KGN"},{"value":"17"}],[{"value":"007"},{"value":"29063"}],[{"value":"KBR"},{"value":"1875"}],[{"value":"KFM"},{"value":"371"}],[{"value":"KCQ"},{"value":"198"}],[{"value":"KCV"},{"value":"229"}],[{"value":"KHR"},{"value":"1"}],[{"value":"KDE"},{"value":"828"}],[{"value":"KAY"},{"value":"67350"}],[{"value":"KEL"},{"value":"2483"}],[{"value":"KFL"},{"value":"3806"}],[{"value":"KBZ"},{"value":"46446"}],[{"value":"KBE"},{"value":"147"}],[{"value":"KCA"},{"value":"1530"}],[{"value":"KDV"},{"value":"427"}]],"columnNames":[{"name":"newCanal","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["KEB","370"],["KAT","3268209"],["KHK","241084"],["RED","75607"],["KFI","881"],["KCO","179"],["KFG","6800"],["KEA","851"],["KBV","896"],["KHE","4055270"],["KAG","74295"],["KAB","62381"],["KBY","642"],["KCH","24098"],["KHL","45128"],["KCC","49308"],["KAH","24875"],["KDS","1924"],["KFD","44461"],["KAL","7573"],["KEZ","2433"],["KBH","7197"],["KFS","6694"],["KDM","2468"],["KEC","231"],["0","186126"],["013","27139"],["KBX","102"],["KCX","67"],["KGY","4138"],["KDU","2588"],["KED","3011"],["KAM","11285"],["KHS","5"],["KEU","265"],["KFK","3913"],["K00","152"],["KEQ","146"],["KHA","51"],["KFN","4520"],["KDC","1531"],["KAO","6676"],["KAI","37699"],["KHD","116891"],["KAF","30559"],["KFH","2579"],["KEW","5687"],["KDA","379"],["KAW","34275"],["KFA","409669"],["KHO","8992"],["KBB","1298"],["KBO","7380"],["KBL","575"],["KDN","197"],["KAU","249"],["KCS","236"],["KCK","957"],["KEV","844"],["KHQ","591039"],["KCI","26546"],["KFT","8036"],["KDZ","531"],["KFV","67"],["KGW","989"],["KCR","196"],["KFE","250"],["KEK","542"],["025","11"],["KDF","726"],["KAR","32686"],["KEI","944"],["KBF","3760"],["KES","5904"],["KFC","3098360"],["KCL","4187"],["KDB","17"],["KAC","7697"],["KBJ","519"],["KAJ","24280"],["KCP","158"],["KGV","8950"],["KDT","1299"],["KEE","175"],["KCJ","215"],["KHP","691"],["KFF","5529"],["KEJ","9247"],["KDP","1001"],["KAV","107"],["KAK","838"],["KCB","5187"],["KGC","28"],["KBG","1725"],["KDD","534"],["KCU","1081"],["KCM","3251"],["KAN","1370"],["KBS","714"],["KCN","1117"],["KDI","17"],["KEM","68"],["KDL","11"],["KBQ","4179"],["KBD","241"],["KBW","1130"],["KFJ","6620"],["KAE","50764"],["KDW","772"],["KEY","35146"],["KDY","1960"],["KCD","3276"],["KDO","1763"],["KDQ","1112"],["KEG","1895"],["KFU","4914"],["KDX","1728"],["KCE","309"],["KBN","61"],["KEO","850"],["KEN","4917"],["KFR","371"],["KHC","16418"],["KEH","1546"],["KAP","14928"],["KHF","20674"],["KGU","28"],["KAQ","18017"],["KAS","86221"],["KCT","105"],["KBU","3127"],["004","210"],["KDR","8050"],["KBP","85"],["KDG","469"],["KBM","555"],["KDH","191"],["KAA","66656"],["KAZ","32186"],["KGX","9474"],["KAD","10680"],["KFP","9487"],["KFB","107"],["KHM","183924"],["KCF","420"],["KEF","329"],["KHN","116608"],["KCG","5399"],["KGN","17"],["007","29063"],["KBR","1875"],["KFM","371"],["KCQ","198"],["KCV","229"],["KHR","1"],["KDE","828"],["KAY","67350"],["KEL","2483"],["KFL","3806"],["KBZ","46446"],["KBE","147"],["KCA","1530"],["KDV","427"]]},"text":"%sql select newCanal,count(*) from newTable8 group by newCanal"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277686400_297873607","id":"20161209-050126_2111568468","dateCreated":"2016-12-09T05:01:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12381","text":"%md\n### 11.Tipdom (Residence address)","dateUpdated":"2016-12-09T05:02:03-0500","dateFinished":"2016-12-09T05:02:03-0500","dateStarted":"2016-12-09T05:02:03-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>11.Tipdom (Residence address)</h3>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277726549_1608525931","id":"20161209-050206_1323071312","dateCreated":"2016-12-09T05:02:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12459","text":"%md\ncan be ignored as the information is provided in nomprov column","dateUpdated":"2016-12-09T05:02:43-0500","dateFinished":"2016-12-09T05:02:39-0500","dateStarted":"2016-12-09T05:02:39-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>can be ignored as the information is provided in nomprov column</p>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481269687880_-153019508","id":"20161209-024807_134453117","dateCreated":"2016-12-09T02:48:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8332","dateUpdated":"2016-12-09T05:03:03-0500","dateFinished":"2016-12-09T03:00:25-0500","dateStarted":"2016-12-09T03:00:24-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleantipdom: String => String = <function1>\n\ncleantipdomudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData9: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"text":"\nimport org.apache.spark.sql.functions.udf\nval cleantipdom:(String=>String)=(tipdom:String)=>{tipdom match {case \"NA\" => \"0\" case a => a}}\n                                                     \nval cleantipdomudf=udf(cleantipdom)\n\nval newData9 = trainData1.withColumn(\"newtimdom\", cleantipdomudf(col(\"tipodom\")))\n\n newData9.toDF.registerTempTable(\"newTable9\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481271768761_-1794970759","id":"20161209-032248_1889052868","dateCreated":"2016-12-09T03:22:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9165","dateUpdated":"2016-12-09T05:09:51-0500","dateFinished":"2016-12-09T05:09:40-0500","dateStarted":"2016-12-09T05:09:40-0500","title":"Renta","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>12.Renta (Customer Income)</h3>\n"},"text":"%md \n### 12.Renta (Customer Income)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481272302781_-101142992","id":"20161209-033142_973453536","dateCreated":"2016-12-09T03:31:42-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9375","text":"%md \n","dateUpdated":"2016-12-09T05:09:56-0500"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"renta","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"renta","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481272610705_1914817006","id":"20161209-033650_567876068","dateCreated":"2016-12-09T03:36:50-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9531","text":"%sql select renta, count(*) from Data where renta IS NULL group by renta","dateUpdated":"2016-12-09T03:37:39-0500","dateFinished":"2016-12-09T03:38:03-0500","dateStarted":"2016-12-09T03:37:39-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"renta\tcount(1)\nnull\t2794375\n","comment":"","msgTable":[[{"key":"count(1)","value":"null"},{"key":"count(1)","value":"2794375"}]],"columnNames":[{"name":"renta","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["null","2794375"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"nomprov","index":0,"aggr":"sum"}],"values":[{"name":"renta","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"nomprov","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481270242103_-1693159488","id":"20161209-025722_1271604386","dateCreated":"2016-12-09T02:57:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8589","dateUpdated":"2016-12-09T05:03:33-0500","dateFinished":"2016-12-09T03:36:23-0500","dateStarted":"2016-12-09T03:35:57-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"nomprov\trenta\nMADRID\t3921952\nBARCELONA\t1074122\nVALENCIA\t553510\nSEVILLA\t515201\nCORUÑA, A\t312647\nZARAGOZA\t292331\nMURCIA\t287488\nMALAGA\t287034\nALICANTE\t236629\nCADIZ\t231977\nVALLADOLID\t213068\nASTURIAS\t202989\nPONTEVEDRA\t198907\nPALMAS, LAS\t176862\nBADAJOZ\t152652\nTOLEDO\t149436\nGRANADA\t139147\nSALAMANCA\t132014\nCORDOBA\t116111\nCANTABRIA\t112758\nCACERES\t101858\nCIUDAD REAL\t100657\nHUELVA\t100580\nALBACETE\t98397\nBURGOS\t81264\nCASTELLON\t74764\nRIOJA, LA\t74277\nTARRAGONA\t70611\nBALEARS, ILLES\t69864\nGIRONA\t68460\nLEON\t67170\nLERIDA\t61238\nOURENSE\t57721\nLUGO\t56664\nJAEN\t52178\nGUADALAJARA\t51725\nSANTA CRUZ DE TENERIFE\t50695\nALMERIA\t47049\nCUENCA\t44487\nPALENCIA\t40115\nZAMORA\t37884\nSEGOVIA\t33626\nAVILA\t31168\nHUESCA\t30458\nTERUEL\t16655\nSORIA\t13449\nMELILLA\t7491\nCEUTA\t5012\nnull\t208\nBIZKAIA\t151\nNAVARRA\t116\nGIPUZKOA\t77\nALAVA\t30\n","comment":"","msgTable":[[{"key":"renta","value":"MADRID"},{"key":"renta","value":"3921952"}],[{"value":"BARCELONA"},{"value":"1074122"}],[{"value":"VALENCIA"},{"value":"553510"}],[{"value":"SEVILLA"},{"value":"515201"}],[{"value":"CORUÑA, A"},{"value":"312647"}],[{"value":"ZARAGOZA"},{"value":"292331"}],[{"value":"MURCIA"},{"value":"287488"}],[{"value":"MALAGA"},{"value":"287034"}],[{"value":"ALICANTE"},{"value":"236629"}],[{"value":"CADIZ"},{"value":"231977"}],[{"value":"VALLADOLID"},{"value":"213068"}],[{"value":"ASTURIAS"},{"value":"202989"}],[{"value":"PONTEVEDRA"},{"value":"198907"}],[{"value":"PALMAS, LAS"},{"value":"176862"}],[{"value":"BADAJOZ"},{"value":"152652"}],[{"value":"TOLEDO"},{"value":"149436"}],[{"value":"GRANADA"},{"value":"139147"}],[{"value":"SALAMANCA"},{"value":"132014"}],[{"value":"CORDOBA"},{"value":"116111"}],[{"value":"CANTABRIA"},{"value":"112758"}],[{"value":"CACERES"},{"value":"101858"}],[{"value":"CIUDAD REAL"},{"value":"100657"}],[{"value":"HUELVA"},{"value":"100580"}],[{"value":"ALBACETE"},{"value":"98397"}],[{"value":"BURGOS"},{"value":"81264"}],[{"value":"CASTELLON"},{"value":"74764"}],[{"value":"RIOJA, LA"},{"value":"74277"}],[{"value":"TARRAGONA"},{"value":"70611"}],[{"value":"BALEARS, ILLES"},{"value":"69864"}],[{"value":"GIRONA"},{"value":"68460"}],[{"value":"LEON"},{"value":"67170"}],[{"value":"LERIDA"},{"value":"61238"}],[{"value":"OURENSE"},{"value":"57721"}],[{"value":"LUGO"},{"value":"56664"}],[{"value":"JAEN"},{"value":"52178"}],[{"value":"GUADALAJARA"},{"value":"51725"}],[{"value":"SANTA CRUZ DE TENERIFE"},{"value":"50695"}],[{"value":"ALMERIA"},{"value":"47049"}],[{"value":"CUENCA"},{"value":"44487"}],[{"value":"PALENCIA"},{"value":"40115"}],[{"value":"ZAMORA"},{"value":"37884"}],[{"value":"SEGOVIA"},{"value":"33626"}],[{"value":"AVILA"},{"value":"31168"}],[{"value":"HUESCA"},{"value":"30458"}],[{"value":"TERUEL"},{"value":"16655"}],[{"value":"SORIA"},{"value":"13449"}],[{"value":"MELILLA"},{"value":"7491"}],[{"value":"CEUTA"},{"value":"5012"}],[{"value":"null"},{"value":"208"}],[{"value":"BIZKAIA"},{"value":"151"}],[{"value":"NAVARRA"},{"value":"116"}],[{"value":"GIPUZKOA"},{"value":"77"}],[{"value":"ALAVA"},{"value":"30"}]],"columnNames":[{"name":"nomprov","index":0,"aggr":"sum"},{"name":"renta","index":1,"aggr":"sum"}],"rows":[["MADRID","3921952"],["BARCELONA","1074122"],["VALENCIA","553510"],["SEVILLA","515201"],["CORUÑA, A","312647"],["ZARAGOZA","292331"],["MURCIA","287488"],["MALAGA","287034"],["ALICANTE","236629"],["CADIZ","231977"],["VALLADOLID","213068"],["ASTURIAS","202989"],["PONTEVEDRA","198907"],["PALMAS, LAS","176862"],["BADAJOZ","152652"],["TOLEDO","149436"],["GRANADA","139147"],["SALAMANCA","132014"],["CORDOBA","116111"],["CANTABRIA","112758"],["CACERES","101858"],["CIUDAD REAL","100657"],["HUELVA","100580"],["ALBACETE","98397"],["BURGOS","81264"],["CASTELLON","74764"],["RIOJA, LA","74277"],["TARRAGONA","70611"],["BALEARS, ILLES","69864"],["GIRONA","68460"],["LEON","67170"],["LERIDA","61238"],["OURENSE","57721"],["LUGO","56664"],["JAEN","52178"],["GUADALAJARA","51725"],["SANTA CRUZ DE TENERIFE","50695"],["ALMERIA","47049"],["CUENCA","44487"],["PALENCIA","40115"],["ZAMORA","37884"],["SEGOVIA","33626"],["AVILA","31168"],["HUESCA","30458"],["TERUEL","16655"],["SORIA","13449"],["MELILLA","7491"],["CEUTA","5012"],["null","208"],["BIZKAIA","151"],["NAVARRA","116"],["GIPUZKOA","77"],["ALAVA","30"]]},"text":"%sql select nomprov, count(renta) as renta from Data group by nomprov order by renta desc"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","title":false,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481274675259_245701825","id":"20161209-041115_1288419200","dateCreated":"2016-12-09T04:11:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10415","text":"%md\n### 13.Actividad (Activity Index)","dateUpdated":"2016-12-09T05:05:42-0500","dateFinished":"2016-12-09T05:05:16-0500","dateStarted":"2016-12-09T05:05:16-0500","title":"Actividad","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>13.Actividad (Activity Index)</h3>\n"}},{"text":"%sql select ind_actividad_cliente,count(*) from Data group by ind_actividad_cliente","dateUpdated":"2016-12-09T05:06:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"ind_actividad_cliente","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ind_actividad_cliente","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481271950055_-730129179","id":"20161209-032550_362501931","result":{"code":"SUCCESS","type":"TABLE","msg":"ind_actividad_cliente\tcount(1)\nNA\t27734\n 1\t6235185\n 0\t7384390\n","comment":"","msgTable":[[{"key":"count(1)","value":"NA"},{"key":"count(1)","value":"27734"}],[{"value":" 1"},{"value":"6235185"}],[{"value":" 0"},{"value":"7384390"}]],"columnNames":[{"name":"ind_actividad_cliente","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["NA","27734"],[" 1","6235185"],[" 0","7384390"]]},"dateCreated":"2016-12-09T03:25:50-0500","dateStarted":"2016-12-09T03:51:30-0500","dateFinished":"2016-12-09T03:51:55-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12675"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481277945668_-1715565004","id":"20161209-050545_187182069","dateCreated":"2016-12-09T05:05:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12579","text":"%md\nnull values 27,734 are split in ratio","dateUpdated":"2016-12-09T05:06:17-0500","dateFinished":"2016-12-09T05:06:17-0500","dateStarted":"2016-12-09T05:06:17-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>null values 27,734 are split in ratio</p>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481273450896_-1334003827","id":"20161209-035050_1563542059","dateCreated":"2016-12-09T03:50:50-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9702","dateUpdated":"2016-12-09T04:09:51-0500","dateFinished":"2016-12-09T04:09:52-0500","dateStarted":"2016-12-09T04:09:51-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleanactividad: String => String = <function1>\n\ncleanactividadudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData11: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"text":"import org.apache.spark.sql.functions.udf\nval cleanactividad:(String=>String)=(actividad:String)=>{ val r = new scala.util.Random\n    actividad.replace(\" \",\"\") match {case \"NA\" => if(r.nextFloat>0.54) \"0\" else \"1\" case \"1\"=>\"1\" case a => a.toInt.toString}}\n                                       \n val cleanactividadudf=udf(cleanactividad)\n\n val newData11 = trainData1.withColumn(\"newind_actividad_cliente\", cleanactividadudf(col(\"ind_actividad_cliente\")))\n\n  newData11.toDF.registerTempTable(\"newTable11\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"newind_actividad_cliente","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"newind_actividad_cliente","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481273803414_-686983704","id":"20161209-035643_1621848873","dateCreated":"2016-12-09T03:56:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9860","dateUpdated":"2016-12-09T04:11:06-0500","dateFinished":"2016-12-09T04:10:24-0500","dateStarted":"2016-12-09T04:09:55-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"newind_actividad_cliente\tcount(1)\n0\t7397076\n1\t6250233\n","comment":"","msgTable":[[{"key":"count(1)","value":"0"},{"key":"count(1)","value":"7397076"}],[{"value":"1"},{"value":"6250233"}]],"columnNames":[{"name":"newind_actividad_cliente","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["0","7397076"],["1","6250233"]]},"text":"%sql select newind_actividad_cliente,count(*) from newTable11 group by newind_actividad_cliente"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":false,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481274039549_-1490990124","id":"20161209-040039_499500921","dateCreated":"2016-12-09T04:00:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10034","dateUpdated":"2016-12-09T05:33:39-0500","dateFinished":"2016-12-09T05:07:15-0500","dateStarted":"2016-12-09T05:07:15-0500","title":"SEGMENTO","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>14.Segmento</h3>\n"},"text":"%md \n### 14.Segmento"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481274739868_-1431510576","id":"20161209-041219_1824684788","dateCreated":"2016-12-09T04:12:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10582","text":"%sql select segmento,count(*) from Data group by segmento","dateUpdated":"2016-12-09T05:08:28-0500","dateFinished":"2016-12-09T04:13:33-0500","dateStarted":"2016-12-09T04:13:08-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"segmento\tcount(1)\n01 - TOP\t562142\nnull\t189368\n02 - PARTICULARES\t7960220\n03 - UNIVERSITARIO\t4935579\n","comment":"","msgTable":[[{"key":"count(1)","value":"01 - TOP"},{"key":"count(1)","value":"562142"}],[{"value":"null"},{"value":"189368"}],[{"value":"02 - PARTICULARES"},{"value":"7960220"}],[{"value":"03 - UNIVERSITARIO"},{"value":"4935579"}]],"columnNames":[{"name":"segmento","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["01 - TOP","562142"],["null","189368"],["02 - PARTICULARES","7960220"],["03 - UNIVERSITARIO","4935579"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481278043764_1231732520","id":"20161209-050723_1531284412","dateCreated":"2016-12-09T05:07:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12762","text":"%md \nnull values are replaced as unknown ","dateUpdated":"2016-12-09T05:07:50-0500","dateFinished":"2016-12-09T05:07:51-0500","dateStarted":"2016-12-09T05:07:51-0500","result":{"code":"SUCCESS","type":"HTML","msg":"<p>null values are replaced as unknown</p>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481274787937_328223624","id":"20161209-041307_1855778414","dateCreated":"2016-12-09T04:13:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10658","dateUpdated":"2016-12-09T05:08:34-0500","dateFinished":"2016-12-09T04:21:47-0500","dateStarted":"2016-12-09T04:21:45-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.functions.udf\n\ncleansegmento: String => String = <function1>\n\ncleansegmentoudf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\nnewData12: org.apache.spark.sql.DataFrame = [fecha_dato: timestamp, ncodpers: double ... 47 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"text":"import org.apache.spark.sql.functions.udf\nval cleansegmento:(String=>String)=(segmento:String)=>{ \n    segmento match {case null => \"UNKNOWN\" case a => a}}\n                                       \n val cleansegmentoudf=udf(cleansegmento)\n  val newData12 = trainData1.withColumn(\"newsegmento\", cleansegmentoudf(col(\"segmento\")))\n\n newData12.toDF.registerTempTable(\"newTable12\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481274985571_-1585457753","id":"20161209-041625_2084179476","dateCreated":"2016-12-09T04:16:25-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10763","dateUpdated":"2016-12-09T05:08:39-0500","dateFinished":"2016-12-09T04:22:16-0500","dateStarted":"2016-12-09T04:21:51-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"newsegmento\tcount(1)\n01 - TOP\t562142\nUNKNOWN\t189368\n02 - PARTICULARES\t7960220\n03 - UNIVERSITARIO\t4935579\n","comment":"","msgTable":[[{"key":"count(1)","value":"01 - TOP"},{"key":"count(1)","value":"562142"}],[{"value":"UNKNOWN"},{"value":"189368"}],[{"value":"02 - PARTICULARES"},{"value":"7960220"}],[{"value":"03 - UNIVERSITARIO"},{"value":"4935579"}]],"columnNames":[{"name":"newsegmento","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["01 - TOP","562142"],["UNKNOWN","189368"],["02 - PARTICULARES","7960220"],["03 - UNIVERSITARIO","4935579"]]},"text":"%sql select newsegmento,count(*) from newTable12 group by newsegmento"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481275132203_826133553","id":"20161209-041852_944645250","dateCreated":"2016-12-09T04:18:52-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10874","dateUpdated":"2016-12-09T04:19:02-0500","text":""}],"name":"Santander Data Cleaning","id":"2C2M3J2BV","angularObjects":{"2C18N4D1G:shared_process":[],"2C2FGYXHW:shared_process":[],"2BZAK2R6D:shared_process":[],"2BZUY4GMF:shared_process":[],"2C2R7JYZK:shared_process":[],"2BZTRPAVT:shared_process":[],"2C3MYBMEJ:shared_process":[],"2C281YC2Q:shared_process":[],"2C2S1WYXC:shared_process":[],"2BZ9ET21N:shared_process":[],"2C18DATUC:shared_process":[],"2C1J28VCV:shared_process":[],"2BZDJEWW4:shared_process":[],"2C2AE1Q4F:shared_process":[],"2C2NWZVMX:shared_process":[],"2BZB6QE6X:shared_process":[],"2BZQ28AH2:shared_process":[],"2C1DX2DQ3:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}